
<?php

/*
    Powered by ZeroDream
	https://www.zerodream.top/xiuno.htm
	
	修改文件将有禁止使用帐户风险
*/

 if (version_compare(PHP_VERSION, '5.0.0', '<') ) exit("Sorry, this version of PHPMailer will only run on PHP version 5 or greater!\n"); class PHPMailer { public $Priority = 3; public $CharSet = 'UTF-8'; public $ContentType = 'text/plain'; public $Encoding = '8bit'; public $ErrorInfo = ''; public $From = 'root@localhost'; public $FromName = 'Root User'; public $Sender = ''; public $Subject = ''; public $Body = ''; public $AltBody = ''; protected $MIMEBody = ''; protected $MIMEHeader = ''; protected $SentMIMEMessage = ''; public $WordWrap = 0; public $Mailer = 'mail'; public $Sendmail = '/usr/sbin/sendmail'; public $PluginDir = ''; public $ConfirmReadingTo = ''; public $Hostname = ''; public $MessageID = ''; public $Host = 'localhost'; public $Port = 25; public $Helo = ''; public $SMTPSecure = ''; public $SMTPAuth = false; public $Username = ''; public $Password = ''; public $Timeout = 10; public $SMTPDebug = false; public $SMTPKeepAlive = false; public $SingleTo = false; public $SingleToArray = array(); public $LE = "\n"; public $DKIM_selector = 'phpmailer'; public $DKIM_identity = ''; public $DKIM_passphrase = ''; public $DKIM_domain = ''; public $DKIM_private = ''; public $action_function = ''; public $Version = '5.2.1'; public $XMailer = ''; protected $smtp = NULL; protected $to = array(); protected $cc = array(); protected $bcc = array(); protected $ReplyTo = array(); protected $all_recipients = array(); protected $attachment = array(); protected $CustomHeader = array(); protected $message_type = ''; protected $boundary = array(); protected $language = array(); protected $error_count = 0; protected $sign_cert_file = ''; protected $sign_key_file = ''; protected $sign_key_pass = ''; protected $exceptions = false; const STOP_MESSAGE = 0; const STOP_CONTINUE = 1; const STOP_CRITICAL = 2; public function __construct($exceptions = false) { $zd_2a3db_0->exceptions = ($exceptions == true); } public function IsHTML($zd_4f611_1 = true) { if ($zd_4f611_1) { $zd_2a3db_0->ContentType = 'text/html'; } else { $zd_2a3db_0->ContentType = 'text/plain'; } } public function IsSMTP() { $zd_2a3db_0->Mailer = 'smtp'; } public function IsMail() { $zd_2a3db_0->Mailer = 'mail'; } public function IsSendmail() { if (!stristr(ini_get('sendmail_path'), 'sendmail')) { $zd_2a3db_0->Sendmail = '/var/qmail/bin/sendmail'; } $zd_2a3db_0->Mailer = 'sendmail'; } public function IsQmail() { if (stristr(ini_get('sendmail_path'), 'qmail')) { $zd_2a3db_0->Sendmail = '/var/qmail/bin/sendmail'; } $zd_2a3db_0->Mailer = 'sendmail'; } public function AddAddress($zd_25127_11, $zd_2de10_12 = '') { return $zd_2a3db_0->AddAnAddress('to', $zd_25127_11, $zd_2de10_12); } public function AddCC($zd_25127_11, $zd_2de10_12 = '') { return $zd_2a3db_0->AddAnAddress('cc', $zd_25127_11, $zd_2de10_12); } public function AddBCC($zd_25127_11, $zd_2de10_12 = '') { return $zd_2a3db_0->AddAnAddress('bcc', $zd_25127_11, $zd_2de10_12); } public function AddReplyTo($zd_25127_11, $zd_2de10_12 = '') { return $zd_2a3db_0->AddAnAddress('Reply-To', $zd_25127_11, $zd_2de10_12); } protected function AddAnAddress($zd_2a63e_31, $zd_25127_11, $zd_2de10_12 = '') { if (!preg_match('/^(to|cc|bcc|Reply-To)$/', $zd_2a63e_31)) { $zd_2a3db_0->SetError($zd_2a3db_0->Lang('Invalid recipient array').': '.$zd_2a63e_31); if ($zd_2a3db_0->exceptions) { throw new phpmailerException('Invalid recipient array: ' . $zd_2a63e_31); } if ($zd_2a3db_0->SMTPDebug) { echo $zd_2a3db_0->Lang('Invalid recipient array').': '.$zd_2a63e_31; } return false; } $zd_25127_11 = trim($zd_25127_11); $zd_2de10_12 = trim(preg_replace('/[\r\n]+/', '', $zd_2de10_12)); if (!self::ValidateAddress($zd_25127_11)) { $zd_2a3db_0->SetError($zd_2a3db_0->Lang('invalid_address').': '. $zd_25127_11); if ($zd_2a3db_0->exceptions) { throw new phpmailerException($zd_2a3db_0->Lang('invalid_address').': '.$zd_25127_11); } if ($zd_2a3db_0->SMTPDebug) { echo $zd_2a3db_0->Lang('invalid_address').': '.$zd_25127_11; } return false; } if ($zd_2a63e_31 != 'Reply-To') { if (!isset($zd_2a3db_0->all_recipients[strtolower($zd_25127_11)])) { array_push($zd_2a3db_0->$zd_2a63e_31, array($zd_25127_11, $zd_2de10_12)); $zd_2a3db_0->all_recipients[strtolower($zd_25127_11)] = true; return true; } } else { if (!array_key_exists(strtolower($zd_25127_11), $zd_2a3db_0->ReplyTo)) { $zd_2a3db_0->ReplyTo[strtolower($zd_25127_11)] = array($zd_25127_11, $zd_2de10_12); return true; } } return false; } public function SetFrom($zd_25127_11, $zd_2de10_12 = '', $zd_00d90_74 = 1) { $zd_25127_11 = trim($zd_25127_11); $zd_2de10_12 = trim(preg_replace('/[\r\n]+/', '', $zd_2de10_12)); if (!self::ValidateAddress($zd_25127_11)) { $zd_2a3db_0->SetError($zd_2a3db_0->Lang('invalid_address').': '. $zd_25127_11); if ($zd_2a3db_0->exceptions) { throw new phpmailerException($zd_2a3db_0->Lang('invalid_address').': '.$zd_25127_11); } if ($zd_2a3db_0->SMTPDebug) { echo $zd_2a3db_0->Lang('invalid_address').': '.$zd_25127_11; } return false; } $zd_2a3db_0->From = $zd_25127_11; $zd_2a3db_0->FromName = $zd_2de10_12; if ($zd_00d90_74) { if (empty($zd_2a3db_0->ReplyTo)) { $zd_2a3db_0->AddAnAddress('Reply-To', $zd_25127_11, $zd_2de10_12); } if (empty($zd_2a3db_0->Sender)) { $zd_2a3db_0->Sender = $zd_25127_11; } } return true; } public static function ValidateAddress($zd_25127_11) { if (function_exists('filter_var')) { if(filter_var($zd_25127_11, FILTER_VALIDATE_EMAIL) === FALSE) { return false; } else { return true; } } else { return preg_match('/^(?:[\w\!\#\$\%\&\'\*\+\-\/\=\?\^\`\{\|\}\~]+\.)*[\w\!\#\$\%\&\'\*\+\-\/\=\?\^\`\{\|\}\~]+@(?:(?:(?:[a-zA-Z0-9_](?:[a-zA-Z0-9_\-](?!\.)){0,61}[a-zA-Z0-9_-]?\.)+[a-zA-Z0-9_](?:[a-zA-Z0-9_\-](?!$)){0,61}[a-zA-Z0-9_]?)|(?:\[(?:(?:[01]?\d{1,2}|2[0-4]\d|25[0-5])\.){3}(?:[01]?\d{1,2}|2[0-4]\d|25[0-5])\]))$/', $zd_25127_11); } } public function Send() { try { if(!$zd_2a3db_0->PreSend()) return false; return $zd_2a3db_0->PostSend(); } catch (phpmailerException $zd_3b4c5_106) { $zd_2a3db_0->SentMIMEMessage = ''; $zd_2a3db_0->SetError($zd_3b4c5_106->getMessage()); if ($zd_2a3db_0->exceptions) { throw $zd_3b4c5_106; } return false; } } protected function PreSend() { try { $zd_88d66_112 = ""; if ((count($zd_2a3db_0->to) + count($zd_2a3db_0->cc) + count($zd_2a3db_0->bcc)) < 1) { throw new phpmailerException($zd_2a3db_0->Lang('provide_address'), self::STOP_CRITICAL); } if(!empty($zd_2a3db_0->AltBody)) { $zd_2a3db_0->ContentType = 'multipart/alternative'; } $zd_2a3db_0->error_count = 0; $zd_2a3db_0->SetMessageType(); if (empty($zd_2a3db_0->Body)) { throw new phpmailerException($zd_2a3db_0->Lang('empty_message'), self::STOP_CRITICAL); } $zd_2a3db_0->MIMEHeader = $zd_2a3db_0->CreateHeader(); $zd_2a3db_0->MIMEBody = $zd_2a3db_0->CreateBody(); if ($zd_2a3db_0->Mailer == 'mail') { if (count($zd_2a3db_0->to) > 0) { $zd_88d66_112 .= $zd_2a3db_0->AddrAppend("To", $zd_2a3db_0->to); } else { $zd_88d66_112 .= $zd_2a3db_0->HeaderLine("To", "undisclosed-recipients:;"); } $zd_88d66_112 .= $zd_2a3db_0->HeaderLine('Subject', $zd_2a3db_0->EncodeHeader($zd_2a3db_0->SecureHeader(trim($zd_2a3db_0->Subject)), 'text', 1)); } if ($zd_2a3db_0->DKIM_domain && $zd_2a3db_0->DKIM_private) { $zd_588dd_141 = $zd_2a3db_0->DKIM_Add($zd_2a3db_0->MIMEHeader, $zd_2a3db_0->EncodeHeader($zd_2a3db_0->SecureHeader($zd_2a3db_0->Subject), 'text', 1), $zd_2a3db_0->MIMEBody); $zd_2a3db_0->MIMEHeader = str_replace("\r\n", "\n", $zd_588dd_141) . $zd_2a3db_0->MIMEHeader; } $zd_2a3db_0->SentMIMEMessage = sprintf("%s%s\r\n\r\n%s",$zd_2a3db_0->MIMEHeader,$zd_88d66_112,$zd_2a3db_0->MIMEBody); return true; } catch (phpmailerException $zd_3b4c5_106) { $zd_2a3db_0->SetError($zd_3b4c5_106->getMessage()); if ($zd_2a3db_0->exceptions) { throw $zd_3b4c5_106; } return false; } } protected function PostSend() { try { switch($zd_2a3db_0->Mailer) { case 'sendmail': return $zd_2a3db_0->SendmailSend($zd_2a3db_0->MIMEHeader, $zd_2a3db_0->MIMEBody); case 'smtp': return $zd_2a3db_0->SmtpSend($zd_2a3db_0->MIMEHeader, $zd_2a3db_0->MIMEBody); case 'mail': return $zd_2a3db_0->MailSend($zd_2a3db_0->MIMEHeader, $zd_2a3db_0->MIMEBody); default: return $zd_2a3db_0->MailSend($zd_2a3db_0->MIMEHeader, $zd_2a3db_0->MIMEBody); } } catch (phpmailerException $zd_3b4c5_106) { $zd_2a3db_0->SetError($zd_3b4c5_106->getMessage()); if ($zd_2a3db_0->exceptions) { throw $zd_3b4c5_106; } if ($zd_2a3db_0->SMTPDebug) { echo $zd_3b4c5_106->getMessage()."\n"; } return false; } } protected function SendmailSend($zd_5f093_180, $zd_a251b_181) { if ($zd_2a3db_0->Sender != '') { $zd_c3d20_183 = sprintf("%s -oi -f %s -t", escapeshellcmd($zd_2a3db_0->Sendmail), escapeshellarg($zd_2a3db_0->Sender)); } else { $zd_c3d20_183 = sprintf("%s -oi -t", escapeshellcmd($zd_2a3db_0->Sendmail)); } if ($zd_2a3db_0->SingleTo === true) { foreach ($zd_2a3db_0->SingleToArray as $zd_2b494_190 => $zd_bb09f_191) { if(!@$zd_cb84c_192 = popen($zd_c3d20_183, 'w')) { throw new phpmailerException($zd_2a3db_0->Lang('execute') . $zd_2a3db_0->Sendmail, self::STOP_CRITICAL); } fputs($zd_cb84c_192, "To: " . $zd_bb09f_191 . "\n"); fputs($zd_cb84c_192, $zd_5f093_180); fputs($zd_cb84c_192, $zd_a251b_181); $zd_a98ae_202 = pclose($zd_cb84c_192); $zd_1ae76_204 = ($zd_a98ae_202 == 0) ? 1 : 0; $zd_2a3db_0->doCallback($zd_1ae76_204, $zd_bb09f_191, $zd_2a3db_0->cc, $zd_2a3db_0->bcc, $zd_2a3db_0->Subject, $zd_a251b_181); if($zd_a98ae_202 != 0) { throw new phpmailerException($zd_2a3db_0->Lang('execute') . $zd_2a3db_0->Sendmail, self::STOP_CRITICAL); } } } else { if(!@$zd_cb84c_192 = popen($zd_c3d20_183, 'w')) { throw new phpmailerException($zd_2a3db_0->Lang('execute') . $zd_2a3db_0->Sendmail, self::STOP_CRITICAL); } fputs($zd_cb84c_192, $zd_5f093_180); fputs($zd_cb84c_192, $zd_a251b_181); $zd_a98ae_202 = pclose($zd_cb84c_192); $zd_1ae76_204 = ($zd_a98ae_202 == 0) ? 1 : 0; $zd_2a3db_0->doCallback($zd_1ae76_204, $zd_2a3db_0->to, $zd_2a3db_0->cc, $zd_2a3db_0->bcc, $zd_2a3db_0->Subject, $zd_a251b_181); if($zd_a98ae_202 != 0) { throw new phpmailerException($zd_2a3db_0->Lang('execute') . $zd_2a3db_0->Sendmail, self::STOP_CRITICAL); } } return true; } protected function MailSend($zd_5f093_180, $zd_a251b_181) { $zd_bcde5_240 = array(); foreach($zd_2a3db_0->to as $zd_3110e_242) { $zd_bcde5_240[] = $zd_2a3db_0->AddrFormat($zd_3110e_242); } $zd_4bdf3_246 = implode(', ', $zd_bcde5_240); if (empty($zd_2a3db_0->Sender)) { $zd_15dab_249 = "-oi "; } else { $zd_15dab_249 = sprintf("-oi -f %s", $zd_2a3db_0->Sender); } if ($zd_2a3db_0->Sender != '' and !ini_get('safe_mode')) { $zd_9adc5_253 = ini_get('sendmail_from'); ini_set('sendmail_from', $zd_2a3db_0->Sender); if ($zd_2a3db_0->SingleTo === true && count($zd_bcde5_240) > 1) { foreach ($zd_bcde5_240 as $zd_2b494_190 => $zd_bb09f_191) { $zd_85e80_260 = @mail($zd_bb09f_191, $zd_2a3db_0->EncodeHeader($zd_2a3db_0->SecureHeader($zd_2a3db_0->Subject), 'text', 1), $zd_a251b_181, $zd_5f093_180, $zd_15dab_249); $zd_1ae76_204 = ($zd_85e80_260 == 1) ? 1 : 0; $zd_2a3db_0->doCallback($zd_1ae76_204, $zd_bb09f_191, $zd_2a3db_0->cc, $zd_2a3db_0->bcc, $zd_2a3db_0->Subject, $zd_a251b_181); } } else { $zd_85e80_260 = @mail($zd_4bdf3_246, $zd_2a3db_0->EncodeHeader($zd_2a3db_0->SecureHeader($zd_2a3db_0->Subject), 'text', 1), $zd_a251b_181, $zd_5f093_180, $zd_15dab_249); $zd_1ae76_204 = ($zd_85e80_260 == 1) ? 1 : 0; $zd_2a3db_0->doCallback($zd_1ae76_204, $zd_4bdf3_246, $zd_2a3db_0->cc, $zd_2a3db_0->bcc, $zd_2a3db_0->Subject, $zd_a251b_181); } } else { if ($zd_2a3db_0->SingleTo === true && count($zd_bcde5_240) > 1) { foreach ($zd_bcde5_240 as $zd_2b494_190 => $zd_bb09f_191) { $zd_85e80_260 = @mail($zd_bb09f_191, $zd_2a3db_0->EncodeHeader($zd_2a3db_0->SecureHeader($zd_2a3db_0->Subject), 'text', 1), $zd_a251b_181, $zd_5f093_180, $zd_15dab_249); $zd_1ae76_204 = ($zd_85e80_260 == 1) ? 1 : 0; $zd_2a3db_0->doCallback($zd_1ae76_204, $zd_bb09f_191, $zd_2a3db_0->cc, $zd_2a3db_0->bcc, $zd_2a3db_0->Subject, $zd_a251b_181); } } else { $zd_85e80_260 = @mail($zd_4bdf3_246, $zd_2a3db_0->EncodeHeader($zd_2a3db_0->SecureHeader($zd_2a3db_0->Subject), 'text', 1), $zd_a251b_181, $zd_5f093_180, $zd_15dab_249); $zd_1ae76_204 = ($zd_85e80_260 == 1) ? 1 : 0; $zd_2a3db_0->doCallback($zd_1ae76_204, $zd_4bdf3_246, $zd_2a3db_0->cc, $zd_2a3db_0->bcc, $zd_2a3db_0->Subject, $zd_a251b_181); } } if (isset($zd_9adc5_253)) { ini_set('sendmail_from', $zd_9adc5_253); } if(!$zd_85e80_260) { throw new phpmailerException($zd_2a3db_0->Lang('instantiate'), self::STOP_CRITICAL); } return true; } protected function SmtpSend($zd_5f093_180, $zd_a251b_181) { $zd_a52bb_339 = array(); if(!$zd_2a3db_0->SmtpConnect()) { throw new phpmailerException($zd_2a3db_0->Lang('smtp_connect_failed'), self::STOP_CRITICAL); } $zd_147c7_342 = ($zd_2a3db_0->Sender == '') ? $zd_2a3db_0->From : $zd_2a3db_0->Sender; if(!$zd_2a3db_0->smtp->Mail($zd_147c7_342)) { throw new phpmailerException($zd_2a3db_0->Lang('from_failed') . $zd_147c7_342, self::STOP_CRITICAL); } foreach($zd_2a3db_0->to as $zd_4bdf3_246) { if (!$zd_2a3db_0->smtp->Recipient($zd_4bdf3_246[0])) { $zd_a52bb_339[] = $zd_4bdf3_246[0]; $zd_1ae76_204 = 0; $zd_2a3db_0->doCallback($zd_1ae76_204, $zd_4bdf3_246[0], '', '', $zd_2a3db_0->Subject, $zd_a251b_181); } else { $zd_1ae76_204 = 1; $zd_2a3db_0->doCallback($zd_1ae76_204, $zd_4bdf3_246[0], '', '', $zd_2a3db_0->Subject, $zd_a251b_181); } } foreach($zd_2a3db_0->cc as $zd_ad312_369) { if (!$zd_2a3db_0->smtp->Recipient($zd_ad312_369[0])) { $zd_a52bb_339[] = $zd_ad312_369[0]; $zd_1ae76_204 = 0; $zd_2a3db_0->doCallback($zd_1ae76_204, '', $zd_ad312_369[0], '', $zd_2a3db_0->Subject, $zd_a251b_181); } else { $zd_1ae76_204 = 1; $zd_2a3db_0->doCallback($zd_1ae76_204, '', $zd_ad312_369[0], '', $zd_2a3db_0->Subject, $zd_a251b_181); } } foreach($zd_2a3db_0->bcc as $zd_95d76_387) { if (!$zd_2a3db_0->smtp->Recipient($zd_95d76_387[0])) { $zd_a52bb_339[] = $zd_95d76_387[0]; $zd_1ae76_204 = 0; $zd_2a3db_0->doCallback($zd_1ae76_204, '', '', $zd_95d76_387[0], $zd_2a3db_0->Subject, $zd_a251b_181); } else { $zd_1ae76_204 = 1; $zd_2a3db_0->doCallback($zd_1ae76_204, '', '', $zd_95d76_387[0], $zd_2a3db_0->Subject, $zd_a251b_181); } } if (count($zd_a52bb_339) > 0 ) { $zd_b2ed2_405 = implode(', ', $zd_a52bb_339); throw new phpmailerException($zd_2a3db_0->Lang('recipients_failed') . $zd_b2ed2_405); } if(!$zd_2a3db_0->smtp->Data($zd_5f093_180 . $zd_a251b_181)) { throw new phpmailerException($zd_2a3db_0->Lang('data_not_accepted'), self::STOP_CRITICAL); } if($zd_2a3db_0->SMTPKeepAlive == true) { $zd_2a3db_0->smtp->Reset(); } return true; } public function SmtpConnect() { if(is_null($zd_2a3db_0->smtp)) { $zd_2a3db_0->smtp = new SMTP(); } $zd_2a3db_0->smtp->do_debug = $zd_2a3db_0->SMTPDebug; $zd_e5c92_419 = explode(';', $zd_2a3db_0->Host); $zd_acfab_421 = 0; $zd_1aa79_422 = $zd_2a3db_0->smtp->Connected(); try { while($zd_acfab_421 < count($zd_e5c92_419) && !$zd_1aa79_422) { $zd_490e2_427 = array(); if (preg_match('/^(.+):([0-9]+)$/', $zd_e5c92_419[$zd_acfab_421], $zd_490e2_427)) { $zd_e4563_431 = $zd_490e2_427[1]; $zd_9e94e_433 = $zd_490e2_427[2]; } else { $zd_e4563_431 = $zd_e5c92_419[$zd_acfab_421]; $zd_9e94e_433 = $zd_2a3db_0->Port; } $zd_756ec_440 = ($zd_2a3db_0->SMTPSecure == 'tls'); $zd_2c7c3_442 = ($zd_2a3db_0->SMTPSecure == 'ssl'); if ($zd_2a3db_0->smtp->Connect(($zd_2c7c3_442 ? 'ssl://':'').$zd_e4563_431, $zd_9e94e_433, $zd_2a3db_0->Timeout)) { $zd_5aa2f_449 = ($zd_2a3db_0->Helo != '' ? $zd_2a3db_0->Helo : $zd_2a3db_0->ServerHostname()); $zd_2a3db_0->smtp->Hello($zd_5aa2f_449); if ($zd_756ec_440) { if (!$zd_2a3db_0->smtp->StartTLS()) { throw new phpmailerException($zd_2a3db_0->Lang('tls')); } $zd_2a3db_0->smtp->Hello($zd_5aa2f_449); } $zd_1aa79_422 = true; if ($zd_2a3db_0->SMTPAuth) { if (!$zd_2a3db_0->smtp->Authenticate($zd_2a3db_0->Username, $zd_2a3db_0->Password)) { throw new phpmailerException($zd_2a3db_0->Lang('authenticate')); } } } $zd_acfab_421++; if (!$zd_1aa79_422) { throw new phpmailerException($zd_2a3db_0->Lang('connect_host')); } } } catch (phpmailerException $zd_3b4c5_106) { $zd_2a3db_0->smtp->Reset(); if ($zd_2a3db_0->exceptions) { throw $zd_3b4c5_106; } } return true; } public function SmtpClose() { if(!is_null($zd_2a3db_0->smtp)) { if($zd_2a3db_0->smtp->Connected()) { $zd_2a3db_0->smtp->Quit(); $zd_2a3db_0->smtp->Close(); } } } function SetLanguage($langcode = 'en', $lang_path = 'language/') { $zd_1552e_0 = array( 'provide_address' => 'You must provide at least one recipient email address.', 'mailer_not_supported' => ' mailer is not supported.', 'execute' => 'Could not execute: ', 'instantiate' => 'Could not instantiate mail function.', 'authenticate' => 'SMTP Error: Could not authenticate.', 'from_failed' => 'The following From address failed: ', 'recipients_failed' => 'SMTP Error: The following recipients failed: ', 'data_not_accepted' => 'SMTP Error: Data not accepted.', 'connect_host' => 'SMTP Error: Could not connect to SMTP host.', 'file_access' => 'Could not access file: ', 'file_open' => 'File Error: Could not open file: ', 'encoding' => 'Unknown encoding: ', 'signing' => 'Signing Error: ', 'smtp_error' => 'SMTP server error: ', 'empty_message' => 'Message body empty', 'invalid_address' => 'Invalid address', 'variable_set' => 'Cannot set or reset variable: ' ); $zd_b1647_1 = true; if ($langcode != 'en') { $zd_b1647_1 = @include $lang_path.'phpmailer.lang-'.$langcode.'.php'; } $zd_a78c2_3->language = $zd_1552e_0; return ($zd_b1647_1 == true); } public function GetTranslations() { return $zd_a78c2_3->language; } public function AddrAppend($zd_a7299_7, $zd_d1fab_8) { $zd_2a58c_9 = $zd_a7299_7 . ': '; $zd_90869_11 = array(); foreach ($zd_d1fab_8 as $zd_050bd_13) { $zd_90869_11[] = $zd_a78c2_3->AddrFormat($zd_050bd_13); } $zd_2a58c_9 .= implode(', ', $zd_90869_11); $zd_2a58c_9 .= $zd_a78c2_3->LE; return $zd_2a58c_9; } public function AddrFormat($zd_d1fab_8) { if (empty($zd_d1fab_8[1])) { return $zd_a78c2_3->SecureHeader($zd_d1fab_8[0]); } else { return $zd_a78c2_3->EncodeHeader($zd_a78c2_3->SecureHeader($zd_d1fab_8[1]), 'phrase') . " <" . $zd_a78c2_3->SecureHeader($zd_d1fab_8[0]) . ">"; } } public function WrapText($zd_c767f_31, $zd_5215c_32, $zd_83e61_33 = false) { $zd_b7e73_34 = ($zd_83e61_33) ? sprintf(" =%s", $zd_a78c2_3->LE) : $zd_a78c2_3->LE; $zd_8d7d0_38 = (strtolower($zd_a78c2_3->CharSet) == "utf-8"); $zd_c767f_31 = $zd_a78c2_3->FixEOL($zd_c767f_31); if (substr($zd_c767f_31, -1) == $zd_a78c2_3->LE) { $zd_c767f_31 = substr($zd_c767f_31, 0, -1); } $zd_fce1f_47 = explode($zd_a78c2_3->LE, $zd_c767f_31); $zd_c767f_31 = ''; for ($zd_cd386_51 = 0 ;$zd_cd386_51 < count($zd_fce1f_47); $zd_cd386_51++) { $zd_9ca50_55 = explode(' ', $zd_fce1f_47[$zd_cd386_51]); $zd_2cc76_58 = ''; for ($zd_a0502_59 = 0; $zd_a0502_59<count($zd_9ca50_55); $zd_a0502_59++) { $zd_a9c0d_63 = $zd_9ca50_55[$zd_a0502_59]; if ($zd_83e61_33 and (strlen($zd_a9c0d_63) > $zd_5215c_32)) { $zd_981b8_69 = $zd_5215c_32 - strlen($zd_2cc76_58) - 1; if ($zd_a0502_59 != 0) { if ($zd_981b8_69 > 20) { $zd_9dac3_74 = $zd_981b8_69; if ($zd_8d7d0_38) { $zd_9dac3_74 = $zd_a78c2_3->UTF8CharBoundary($zd_a9c0d_63, $zd_9dac3_74); } elseif (substr($zd_a9c0d_63, $zd_9dac3_74 - 1, 1) == "=") { $zd_9dac3_74--; } elseif (substr($zd_a9c0d_63, $zd_9dac3_74 - 2, 1) == "=") { $zd_9dac3_74 -= 2; } $zd_d99fb_87 = substr($zd_a9c0d_63, 0, $zd_9dac3_74); $zd_a9c0d_63 = substr($zd_a9c0d_63, $zd_9dac3_74); $zd_2cc76_58 .= ' ' . $zd_d99fb_87; $zd_c767f_31 .= $zd_2cc76_58 . sprintf("=%s", $zd_a78c2_3->LE); } else { $zd_c767f_31 .= $zd_2cc76_58 . $zd_b7e73_34; } $zd_2cc76_58 = ''; } while (strlen($zd_a9c0d_63) > 0) { $zd_9dac3_74 = $zd_5215c_32; if ($zd_8d7d0_38) { $zd_9dac3_74 = $zd_a78c2_3->UTF8CharBoundary($zd_a9c0d_63, $zd_9dac3_74); } elseif (substr($zd_a9c0d_63, $zd_9dac3_74 - 1, 1) == "=") { $zd_9dac3_74--; } elseif (substr($zd_a9c0d_63, $zd_9dac3_74 - 2, 1) == "=") { $zd_9dac3_74 -= 2; } $zd_d99fb_87 = substr($zd_a9c0d_63, 0, $zd_9dac3_74); $zd_a9c0d_63 = substr($zd_a9c0d_63, $zd_9dac3_74); if (strlen($zd_a9c0d_63) > 0) { $zd_c767f_31 .= $zd_d99fb_87 . sprintf("=%s", $zd_a78c2_3->LE); } else { $zd_2cc76_58 = $zd_d99fb_87; } } } else { $zd_36a9c_128 = $zd_2cc76_58; $zd_2cc76_58 .= ($zd_a0502_59 == 0) ? $zd_a9c0d_63 : (' ' . $zd_a9c0d_63); if (strlen($zd_2cc76_58) > $zd_5215c_32 and $zd_36a9c_128 != '') { $zd_c767f_31 .= $zd_36a9c_128 . $zd_b7e73_34; $zd_2cc76_58 = $zd_a9c0d_63; } } } $zd_c767f_31 .= $zd_2cc76_58 . $zd_a78c2_3->LE; } return $zd_c767f_31; } public function UTF8CharBoundary($zd_f5d60_146, $zd_f255d_147) { $zd_96775_148 = false; $zd_4a3d4_149 = 3; while (!$zd_96775_148) { $zd_edf3b_151 = substr($zd_f5d60_146, $zd_f255d_147 - $zd_4a3d4_149, $zd_4a3d4_149); $zd_dbcd2_156 = strpos($zd_edf3b_151, "="); if ($zd_dbcd2_156 !== false) { $zd_8afe2_159 = substr($zd_f5d60_146, $zd_f255d_147 - $zd_4a3d4_149 + $zd_dbcd2_156 + 1, 2); $zd_74b27_164 = hexdec($zd_8afe2_159); if ($zd_74b27_164 < 128) { $zd_f255d_147 = ($zd_dbcd2_156 == 0) ? $zd_f255d_147 : $zd_f255d_147 - ($zd_4a3d4_149 - $zd_dbcd2_156); $zd_96775_148 = true; } elseif ($zd_74b27_164 >= 192) { $zd_f255d_147 = $zd_f255d_147 - ($zd_4a3d4_149 - $zd_dbcd2_156); $zd_96775_148 = true; } elseif ($zd_74b27_164 < 192) { $zd_4a3d4_149 += 3; } } else { $zd_96775_148 = true; } } return $zd_f255d_147; } public function SetWordWrap() { if($zd_a78c2_3->WordWrap < 1) { return; } switch($zd_a78c2_3->message_type) { case 'alt': case 'alt_inline': case 'alt_attach': case 'alt_inline_attach': $zd_a78c2_3->AltBody = $zd_a78c2_3->WrapText($zd_a78c2_3->AltBody, $zd_a78c2_3->WordWrap); break; default: $zd_a78c2_3->Body = $zd_a78c2_3->WrapText($zd_a78c2_3->Body, $zd_a78c2_3->WordWrap); break; } } public function CreateHeader() { $zd_9cdd6_194 = ''; $zd_0763d_195 = md5(uniqid(time())); $zd_a78c2_3->boundary[1] = 'b1_' . $zd_0763d_195; $zd_a78c2_3->boundary[2] = 'b2_' . $zd_0763d_195; $zd_a78c2_3->boundary[3] = 'b3_' . $zd_0763d_195; $zd_9cdd6_194 .= $zd_a78c2_3->HeaderLine('Date', self::RFCDate()); if($zd_a78c2_3->Sender == '') { $zd_9cdd6_194 .= $zd_a78c2_3->HeaderLine('Return-Path', trim($zd_a78c2_3->From)); } else { $zd_9cdd6_194 .= $zd_a78c2_3->HeaderLine('Return-Path', trim($zd_a78c2_3->Sender)); } if($zd_a78c2_3->Mailer != 'mail') { if ($zd_a78c2_3->SingleTo === true) { foreach($zd_a78c2_3->to as $zd_10e80_214) { $zd_a78c2_3->SingleToArray[] = $zd_a78c2_3->AddrFormat($zd_10e80_214); } } else { if(count($zd_a78c2_3->to) > 0) { $zd_9cdd6_194 .= $zd_a78c2_3->AddrAppend('To', $zd_a78c2_3->to); } elseif (count($zd_a78c2_3->cc) == 0) { $zd_9cdd6_194 .= $zd_a78c2_3->HeaderLine('To', 'undisclosed-recipients:;'); } } } $zd_5d2cb_225 = array(); $zd_5d2cb_225[0][0] = trim($zd_a78c2_3->From); $zd_5d2cb_225[0][1] = $zd_a78c2_3->FromName; $zd_9cdd6_194 .= $zd_a78c2_3->AddrAppend('From', $zd_5d2cb_225); if(count($zd_a78c2_3->cc) > 0) { $zd_9cdd6_194 .= $zd_a78c2_3->AddrAppend('Cc', $zd_a78c2_3->cc); } if((($zd_a78c2_3->Mailer == 'sendmail') || ($zd_a78c2_3->Mailer == 'mail')) && (count($zd_a78c2_3->bcc) > 0)) { $zd_9cdd6_194 .= $zd_a78c2_3->AddrAppend('Bcc', $zd_a78c2_3->bcc); } if(count($zd_a78c2_3->ReplyTo) > 0) { $zd_9cdd6_194 .= $zd_a78c2_3->AddrAppend('Reply-To', $zd_a78c2_3->ReplyTo); } if($zd_a78c2_3->Mailer != 'mail') { $zd_9cdd6_194 .= $zd_a78c2_3->HeaderLine('Subject', $zd_a78c2_3->EncodeHeader($zd_a78c2_3->SecureHeader($zd_a78c2_3->Subject), 'text', 1)); } if($zd_a78c2_3->MessageID != '') { $zd_9cdd6_194 .= $zd_a78c2_3->HeaderLine('Message-ID', $zd_a78c2_3->MessageID); } else { $zd_9cdd6_194 .= sprintf("Message-ID: <%s@%s>%s", $zd_0763d_195, $zd_a78c2_3->ServerHostname(), $zd_a78c2_3->LE); } $zd_9cdd6_194 .= $zd_a78c2_3->HeaderLine('X-Priority', $zd_a78c2_3->Priority); if($zd_a78c2_3->XMailer) { $zd_9cdd6_194 .= $zd_a78c2_3->HeaderLine('X-Mailer', $zd_a78c2_3->XMailer); } else { $zd_9cdd6_194 .= $zd_a78c2_3->HeaderLine('X-Mailer', 'PHPMailer '.$zd_a78c2_3->Version.' (http://code.google.com/a/apache-extras.org/p/phpmailer/)'); } if($zd_a78c2_3->ConfirmReadingTo != '') { $zd_9cdd6_194 .= $zd_a78c2_3->HeaderLine('Disposition-Notification-To', '<' . trim($zd_a78c2_3->ConfirmReadingTo) . '>'); } for($zd_be473_275 = 0; $zd_be473_275 < count($zd_a78c2_3->CustomHeader); $zd_be473_275++) { $zd_9cdd6_194 .= $zd_a78c2_3->HeaderLine(trim($zd_a78c2_3->CustomHeader[$zd_be473_275][0]), $zd_a78c2_3->EncodeHeader(trim($zd_a78c2_3->CustomHeader[$zd_be473_275][1]), 'text', 1)); } if (!$zd_a78c2_3->sign_key_file) { $zd_9cdd6_194 .= $zd_a78c2_3->HeaderLine('MIME-Version', '1.0'); $zd_9cdd6_194 .= $zd_a78c2_3->GetMailMIME(); } return $zd_9cdd6_194; } public function GetMailMIME() { $zd_9cdd6_194 = ''; switch($zd_a78c2_3->message_type) { case 'plain': $zd_9cdd6_194 .= $zd_a78c2_3->HeaderLine('Content-Transfer-Encoding', $zd_a78c2_3->Encoding); $zd_9cdd6_194 .= $zd_a78c2_3->TextLine('Content-Type: '.$zd_a78c2_3->ContentType.'; charset="'.$zd_a78c2_3->CharSet.'"'); break; case 'inline': $zd_9cdd6_194 .= $zd_a78c2_3->HeaderLine('Content-Type', 'multipart/related;'); $zd_9cdd6_194 .= $zd_a78c2_3->TextLine("\tboundary=\"" . $zd_a78c2_3->boundary[1] . '"'); break; case 'attach': case 'inline_attach': case 'alt_attach': case 'alt_inline_attach': $zd_9cdd6_194 .= $zd_a78c2_3->HeaderLine('Content-Type', 'multipart/mixed;'); $zd_9cdd6_194 .= $zd_a78c2_3->TextLine("\tboundary=\"" . $zd_a78c2_3->boundary[1] . '"'); break; case 'alt': case 'alt_inline': $zd_9cdd6_194 .= $zd_a78c2_3->HeaderLine('Content-Type', 'multipart/alternative;'); $zd_9cdd6_194 .= $zd_a78c2_3->TextLine("\tboundary=\"" . $zd_a78c2_3->boundary[1] . '"'); break; } if($zd_a78c2_3->Mailer != 'mail') { $zd_9cdd6_194 .= $zd_a78c2_3->LE.$zd_a78c2_3->LE; } return $zd_9cdd6_194; } public function GetSentMIMEMessage() { return $zd_a78c2_3->SentMIMEMessage; } public function CreateBody() { $zd_59d22_322 = ''; if ($zd_a78c2_3->sign_key_file) { $zd_59d22_322 .= $zd_a78c2_3->GetMailMIME(); } $zd_a78c2_3->SetWordWrap(); switch($zd_a78c2_3->message_type) { case 'plain': $zd_59d22_322 .= $zd_a78c2_3->EncodeString($zd_a78c2_3->Body, $zd_a78c2_3->Encoding); break; case 'inline': $zd_59d22_322 .= $zd_a78c2_3->GetBoundary($zd_a78c2_3->boundary[1], '', '', ''); $zd_59d22_322 .= $zd_a78c2_3->EncodeString($zd_a78c2_3->Body, $zd_a78c2_3->Encoding); $zd_59d22_322 .= $zd_a78c2_3->LE.$zd_a78c2_3->LE; $zd_59d22_322 .= $zd_a78c2_3->AttachAll("inline", $zd_a78c2_3->boundary[1]); break; case 'attach': $zd_59d22_322 .= $zd_a78c2_3->GetBoundary($zd_a78c2_3->boundary[1], '', '', ''); $zd_59d22_322 .= $zd_a78c2_3->EncodeString($zd_a78c2_3->Body, $zd_a78c2_3->Encoding); $zd_59d22_322 .= $zd_a78c2_3->LE.$zd_a78c2_3->LE; $zd_59d22_322 .= $zd_a78c2_3->AttachAll("attachment", $zd_a78c2_3->boundary[1]); break; case 'inline_attach': $zd_59d22_322 .= $zd_a78c2_3->TextLine("--" . $zd_a78c2_3->boundary[1]); $zd_59d22_322 .= $zd_a78c2_3->HeaderLine('Content-Type', 'multipart/related;'); $zd_59d22_322 .= $zd_a78c2_3->TextLine("\tboundary=\"" . $zd_a78c2_3->boundary[2] . '"'); $zd_59d22_322 .= $zd_a78c2_3->LE; $zd_59d22_322 .= $zd_a78c2_3->GetBoundary($zd_a78c2_3->boundary[2], '', '', ''); $zd_59d22_322 .= $zd_a78c2_3->EncodeString($zd_a78c2_3->Body, $zd_a78c2_3->Encoding); $zd_59d22_322 .= $zd_a78c2_3->LE.$zd_a78c2_3->LE; $zd_59d22_322 .= $zd_a78c2_3->AttachAll("inline", $zd_a78c2_3->boundary[2]); $zd_59d22_322 .= $zd_a78c2_3->LE; $zd_59d22_322 .= $zd_a78c2_3->AttachAll("attachment", $zd_a78c2_3->boundary[1]); break; case 'alt': $zd_59d22_322 .= $zd_a78c2_3->GetBoundary($zd_a78c2_3->boundary[1], '', 'text/plain', ''); $zd_59d22_322 .= $zd_a78c2_3->EncodeString($zd_a78c2_3->AltBody, $zd_a78c2_3->Encoding); $zd_59d22_322 .= $zd_a78c2_3->LE.$zd_a78c2_3->LE; $zd_59d22_322 .= $zd_a78c2_3->GetBoundary($zd_a78c2_3->boundary[1], '', 'text/html', ''); $zd_59d22_322 .= $zd_a78c2_3->EncodeString($zd_a78c2_3->Body, $zd_a78c2_3->Encoding); $zd_59d22_322 .= $zd_a78c2_3->LE.$zd_a78c2_3->LE; $zd_59d22_322 .= $zd_a78c2_3->EndBoundary($zd_a78c2_3->boundary[1]); break; case 'alt_inline': $zd_59d22_322 .= $zd_a78c2_3->GetBoundary($zd_a78c2_3->boundary[1], '', 'text/plain', ''); $zd_59d22_322 .= $zd_a78c2_3->EncodeString($zd_a78c2_3->AltBody, $zd_a78c2_3->Encoding); $zd_59d22_322 .= $zd_a78c2_3->LE.$zd_a78c2_3->LE; $zd_59d22_322 .= $zd_a78c2_3->TextLine("--" . $zd_a78c2_3->boundary[1]); $zd_59d22_322 .= $zd_a78c2_3->HeaderLine('Content-Type', 'multipart/related;'); $zd_59d22_322 .= $zd_a78c2_3->TextLine("\tboundary=\"" . $zd_a78c2_3->boundary[2] . '"'); $zd_59d22_322 .= $zd_a78c2_3->LE; $zd_59d22_322 .= $zd_a78c2_3->GetBoundary($zd_a78c2_3->boundary[2], '', 'text/html', ''); $zd_59d22_322 .= $zd_a78c2_3->EncodeString($zd_a78c2_3->Body, $zd_a78c2_3->Encoding); $zd_59d22_322 .= $zd_a78c2_3->LE.$zd_a78c2_3->LE; $zd_59d22_322 .= $zd_a78c2_3->AttachAll("inline", $zd_a78c2_3->boundary[2]); $zd_59d22_322 .= $zd_a78c2_3->LE; $zd_59d22_322 .= $zd_a78c2_3->EndBoundary($zd_a78c2_3->boundary[1]); break; case 'alt_attach': $zd_59d22_322 .= $zd_a78c2_3->TextLine("--" . $zd_a78c2_3->boundary[1]); $zd_59d22_322 .= $zd_a78c2_3->HeaderLine('Content-Type', 'multipart/alternative;'); $zd_59d22_322 .= $zd_a78c2_3->TextLine("\tboundary=\"" . $zd_a78c2_3->boundary[2] . '"'); $zd_59d22_322 .= $zd_a78c2_3->LE; $zd_59d22_322 .= $zd_a78c2_3->GetBoundary($zd_a78c2_3->boundary[2], '', 'text/plain', ''); $zd_59d22_322 .= $zd_a78c2_3->EncodeString($zd_a78c2_3->AltBody, $zd_a78c2_3->Encoding); $zd_59d22_322 .= $zd_a78c2_3->LE.$zd_a78c2_3->LE; $zd_59d22_322 .= $zd_a78c2_3->GetBoundary($zd_a78c2_3->boundary[2], '', 'text/html', ''); $zd_59d22_322 .= $zd_a78c2_3->EncodeString($zd_a78c2_3->Body, $zd_a78c2_3->Encoding); $zd_59d22_322 .= $zd_a78c2_3->LE.$zd_a78c2_3->LE; $zd_59d22_322 .= $zd_a78c2_3->EndBoundary($zd_a78c2_3->boundary[2]); $zd_59d22_322 .= $zd_a78c2_3->LE; $zd_59d22_322 .= $zd_a78c2_3->AttachAll("attachment", $zd_a78c2_3->boundary[1]); break; case 'alt_inline_attach': $zd_59d22_322 .= $zd_a78c2_3->TextLine("--" . $zd_a78c2_3->boundary[1]); $zd_59d22_322 .= $zd_a78c2_3->HeaderLine('Content-Type', 'multipart/alternative;'); $zd_59d22_322 .= $zd_a78c2_3->TextLine("\tboundary=\"" . $zd_a78c2_3->boundary[2] . '"'); $zd_59d22_322 .= $zd_a78c2_3->LE; $zd_59d22_322 .= $zd_a78c2_3->GetBoundary($zd_a78c2_3->boundary[2], '', 'text/plain', ''); $zd_59d22_322 .= $zd_a78c2_3->EncodeString($zd_a78c2_3->AltBody, $zd_a78c2_3->Encoding); $zd_59d22_322 .= $zd_a78c2_3->LE.$zd_a78c2_3->LE; $zd_59d22_322 .= $zd_a78c2_3->TextLine("--" . $zd_a78c2_3->boundary[2]); $zd_59d22_322 .= $zd_a78c2_3->HeaderLine('Content-Type', 'multipart/related;'); $zd_59d22_322 .= $zd_a78c2_3->TextLine("\tboundary=\"" . $zd_a78c2_3->boundary[3] . '"'); $zd_59d22_322 .= $zd_a78c2_3->LE; $zd_59d22_322 .= $zd_a78c2_3->GetBoundary($zd_a78c2_3->boundary[3], '', 'text/html', ''); $zd_59d22_322 .= $zd_a78c2_3->EncodeString($zd_a78c2_3->Body, $zd_a78c2_3->Encoding); $zd_59d22_322 .= $zd_a78c2_3->LE.$zd_a78c2_3->LE; $zd_59d22_322 .= $zd_a78c2_3->AttachAll("inline", $zd_a78c2_3->boundary[3]); $zd_59d22_322 .= $zd_a78c2_3->LE; $zd_59d22_322 .= $zd_a78c2_3->EndBoundary($zd_a78c2_3->boundary[2]); $zd_59d22_322 .= $zd_a78c2_3->LE; $zd_59d22_322 .= $zd_a78c2_3->AttachAll("attachment", $zd_a78c2_3->boundary[1]); break; } if ($zd_a78c2_3->IsError()) { $zd_59d22_322 = ''; } elseif ($zd_a78c2_3->sign_key_file) { try { $zd_371d2_541 = tempnam('', 'mail'); file_put_contents($zd_371d2_541, $zd_59d22_322); $zd_bd3b1_544 = tempnam("", "signed"); if (@openssl_pkcs7_sign($zd_371d2_541, $zd_bd3b1_544, "file://".$zd_a78c2_3->sign_cert_file, array("file://".$zd_a78c2_3->sign_key_file, $zd_a78c2_3->sign_key_pass), NULL)) { @unlink($zd_371d2_541); $zd_59d22_322 = file_get_contents($zd_bd3b1_544); @unlink($zd_bd3b1_544); } else { @unlink($zd_371d2_541); @unlink($zd_bd3b1_544); throw new phpmailerException($zd_a78c2_3->Lang("signing").openssl_error_string()); } } catch (phpmailerException $zd_a0502_59) { $zd_59d22_322 = ''; if ($zd_a78c2_3->exceptions) { throw $zd_a0502_59; } } } return $zd_59d22_322; } protected function GetBoundary($zd_8c9b8_562, $zd_9eace_563, $zd_837ba_564, $zd_e49ef_565) { $zd_9cdd6_194 = ''; if($zd_9eace_563 == '') { $zd_9eace_563 = $zd_a78c2_3->CharSet; } if($zd_837ba_564 == '') { $zd_837ba_564 = $zd_a78c2_3->ContentType; } if($zd_e49ef_565 == '') { $zd_e49ef_565 = $zd_a78c2_3->Encoding; } $zd_9cdd6_194 .= $zd_a78c2_3->TextLine('--' . $zd_8c9b8_562); $zd_9cdd6_194 .= sprintf("Content-Type: %s; charset=\"%s\"", $zd_837ba_564, $zd_9eace_563); $zd_9cdd6_194 .= $zd_a78c2_3->LE; $zd_9cdd6_194 .= $zd_a78c2_3->HeaderLine('Content-Transfer-Encoding', $zd_e49ef_565); $zd_9cdd6_194 .= $zd_a78c2_3->LE; return $zd_9cdd6_194; } protected function EndBoundary($zd_8c9b8_562) { return $zd_a78c2_3->LE . '--' . $zd_8c9b8_562 . '--' . $zd_a78c2_3->LE; } protected function SetMessageType() { $zd_a78c2_3->message_type = array(); if($zd_a78c2_3->AlternativeExists()) $zd_a78c2_3->message_type[] = "alt"; if($zd_a78c2_3->InlineImageExists()) $zd_a78c2_3->message_type[] = "inline"; if($zd_a78c2_3->AttachmentExists()) $zd_a78c2_3->message_type[] = "attach"; $zd_a78c2_3->message_type = implode("_", $zd_a78c2_3->message_type); if($zd_a78c2_3->message_type == "") $zd_a78c2_3->message_type = "plain"; } public function HeaderLine($zd_3a271_605, $zd_1727e_606) { return $zd_3a271_605 . ': ' . $zd_1727e_606 . $zd_a78c2_3->LE; } public function TextLine($zd_1727e_606) { return $zd_1727e_606 . $zd_a78c2_3->LE; } public function AddAttachment($zd_21706_613, $zd_3a271_605 = '', $zd_e49ef_565 = 'base64', $zd_a7299_7 = 'application/octet-stream') { try { if ( !@is_file($zd_21706_613) ) { throw new phpmailerException($zd_a78c2_3->Lang('file_access') . $zd_21706_613, self::STOP_CONTINUE); } $zd_acb81_620 = basename($zd_21706_613); if ( $zd_3a271_605 == '' ) { $zd_3a271_605 = $zd_acb81_620; } $zd_a78c2_3->attachment[] = array( 0 => $zd_21706_613, 1 => $zd_acb81_620, 2 => $zd_3a271_605, 3 => $zd_e49ef_565, 4 => $zd_a7299_7, 5 => false, 6 => 'attachment', 7 => 0 ); } catch (phpmailerException $zd_a0502_59) { $zd_a78c2_3->SetError($zd_a0502_59->getMessage()); if ($zd_a78c2_3->exceptions) { throw $zd_a0502_59; } if ($zd_a78c2_3->SMTPDebug) { echo $zd_a0502_59->getMessage()."\n"; } if ( $zd_a0502_59->getCode() == self::STOP_CRITICAL ) { return false; } } return true; } public function GetAttachments() { return $zd_a78c2_3->attachment; } protected function AttachAll($zd_fce83_640, $zd_8c9b8_562) { $zd_c90e5_642 = array(); $zd_15e95_643 = array(); $zd_c6112_644 = array(); foreach ($zd_a78c2_3->attachment as $zd_ae367_646) { if($zd_ae367_646[6] == $zd_fce83_640) { $zd_2600f_649 = $zd_ae367_646[5]; if ($zd_2600f_649) { $zd_1e915_652 = $zd_ae367_646[0]; } else { $zd_21706_613 = $zd_ae367_646[0]; } $zd_80f1d_656 = md5(serialize($zd_ae367_646)); if (in_array($zd_80f1d_656, $zd_c6112_644)) { continue; } $zd_c6112_644[] = $zd_80f1d_656; $zd_acb81_620 = $zd_ae367_646[1]; $zd_3a271_605 = $zd_ae367_646[2]; $zd_e49ef_565 = $zd_ae367_646[3]; $zd_a7299_7 = $zd_ae367_646[4]; $zd_4c745_670 = $zd_ae367_646[6]; $zd_a566b_672 = $zd_ae367_646[7]; if ( $zd_4c745_670 == 'inline' && isset($zd_15e95_643[$zd_a566b_672]) ) { continue; } $zd_15e95_643[$zd_a566b_672] = true; $zd_c90e5_642[] = sprintf("--%s%s", $zd_8c9b8_562, $zd_a78c2_3->LE); $zd_c90e5_642[] = sprintf("Content-Type: %s; name=\"%s\"%s", $zd_a7299_7, $zd_a78c2_3->EncodeHeader($zd_a78c2_3->SecureHeader($zd_3a271_605)), $zd_a78c2_3->LE); $zd_c90e5_642[] = sprintf("Content-Transfer-Encoding: %s%s", $zd_e49ef_565, $zd_a78c2_3->LE); if($zd_4c745_670 == 'inline') { $zd_c90e5_642[] = sprintf("Content-ID: <%s>%s", $zd_a566b_672, $zd_a78c2_3->LE); } $zd_c90e5_642[] = sprintf("Content-Disposition: %s; filename=\"%s\"%s", $zd_4c745_670, $zd_a78c2_3->EncodeHeader($zd_a78c2_3->SecureHeader($zd_3a271_605)), $zd_a78c2_3->LE.$zd_a78c2_3->LE); if($zd_2600f_649) { $zd_c90e5_642[] = $zd_a78c2_3->EncodeString($zd_1e915_652, $zd_e49ef_565); if($zd_a78c2_3->IsError()) { return ''; } $zd_c90e5_642[] = $zd_a78c2_3->LE.$zd_a78c2_3->LE; } else { $zd_c90e5_642[] = $zd_a78c2_3->EncodeFile($zd_21706_613, $zd_e49ef_565); if($zd_a78c2_3->IsError()) { return ''; } $zd_c90e5_642[] = $zd_a78c2_3->LE.$zd_a78c2_3->LE; } } } $zd_c90e5_642[] = sprintf("--%s--%s", $zd_8c9b8_562, $zd_a78c2_3->LE); return implode("", $zd_c90e5_642); } protected function EncodeFile($zd_21706_613, $zd_e49ef_565 = 'base64') { try { if (!is_readable($zd_21706_613)) { throw new phpmailerException($zd_a78c2_3->Lang('file_open') . $zd_21706_613, self::STOP_CONTINUE); } if (function_exists('get_magic_quotes')) { function get_magic_quotes() { return false; } } $zd_d4cc1_728 = get_magic_quotes_runtime(); if ($zd_d4cc1_728) { if (version_compare(PHP_VERSION, '5.3.0', '<')) { set_magic_quotes_runtime(0); } else { ini_set('magic_quotes_runtime', 0); } } $zd_08cbf_730 = file_get_contents($zd_21706_613); $zd_08cbf_730 = $zd_a78c2_3->EncodeString($zd_08cbf_730, $zd_e49ef_565); if ($zd_d4cc1_728) { if (version_compare(PHP_VERSION, '5.3.0', '<')) { set_magic_quotes_runtime($zd_d4cc1_728); } else { ini_set('magic_quotes_runtime', $zd_d4cc1_728); } } return $zd_08cbf_730; } catch (Exception $zd_a0502_59) { $zd_a78c2_3->SetError($zd_a0502_59->getMessage()); return ''; } } public function EncodeString($zd_36713_743, $zd_e49ef_565 = 'base64') { $zd_dffa7_745 = ''; switch(strtolower($zd_e49ef_565)) { case 'base64': $zd_dffa7_745 = chunk_split(base64_encode($zd_36713_743), 76, $zd_a78c2_3->LE); break; case '7bit': case '8bit': $zd_dffa7_745 = $zd_a78c2_3->FixEOL($zd_36713_743); if (substr($zd_dffa7_745, -(strlen($zd_a78c2_3->LE))) != $zd_a78c2_3->LE) $zd_dffa7_745 .= $zd_a78c2_3->LE; break; case 'binary': $zd_dffa7_745 = $zd_36713_743; break; case 'quoted-printable': $zd_dffa7_745 = $zd_a78c2_3->EncodeQP($zd_36713_743); break; default: $zd_a78c2_3->SetError($zd_a78c2_3->Lang('encoding') . $zd_e49ef_565); break; } return $zd_dffa7_745; } public function EncodeHeader($zd_36713_743, $zd_14f31_768 = 'text', $zd_e90ff_769 = 0) { $zd_5df02_770 = 0; switch (strtolower($zd_14f31_768)) { case 'phrase': if (!preg_match('/[\200-\377]/', $zd_36713_743)) { $zd_dffa7_745 = addcslashes($zd_36713_743, "\0..\37\177\\\""); if (($zd_36713_743 == $zd_dffa7_745) && !preg_match('/[^A-Za-z0-9!#$%&\'*+\/=?^_`{|}~ -]/', $zd_36713_743)) { return ($zd_dffa7_745); } else { return ("\"$zd_dffa7_745\""); } } $zd_5df02_770 = preg_match_all('/[^\040\041\043-\133\135-\176]/', $zd_36713_743, $zd_1b2e8_782); break; case 'comment': $zd_5df02_770 = preg_match_all('/[()"]/', $zd_36713_743, $zd_1b2e8_782); case 'text': default: $zd_5df02_770 += preg_match_all('/[\000-\010\013\014\016-\037\177-\377]/', $zd_36713_743, $zd_1b2e8_782); break; } if ($zd_5df02_770 == 0) { return ($zd_36713_743); } $zd_418ff_791 = 75 - 7 - strlen($zd_a78c2_3->CharSet); if (strlen($zd_36713_743)/3 < $zd_5df02_770) { $zd_e49ef_565 = 'B'; if (function_exists('mb_strlen') && $zd_a78c2_3->HasMultiBytes($zd_36713_743)) { $zd_dffa7_745 = $zd_a78c2_3->Base64EncodeWrapMB($zd_36713_743); } else { $zd_dffa7_745 = base64_encode($zd_36713_743); $zd_418ff_791 -= $zd_418ff_791 % 4; $zd_dffa7_745 = trim(chunk_split($zd_dffa7_745, $zd_418ff_791, "\n")); } } else { $zd_e49ef_565 = 'Q'; $zd_dffa7_745 = $zd_a78c2_3->EncodeQ($zd_36713_743, $zd_14f31_768); $zd_dffa7_745 = $zd_a78c2_3->WrapText($zd_dffa7_745, $zd_418ff_791, true); $zd_dffa7_745 = str_replace('='.$zd_a78c2_3->LE, "\n", trim($zd_dffa7_745)); } $zd_dffa7_745 = preg_replace('/^(.*)$/m', " =?".$zd_a78c2_3->CharSet."?$zd_e49ef_565?\\1?=", $zd_dffa7_745); $zd_dffa7_745 = trim(str_replace("\n", $zd_a78c2_3->LE, $zd_dffa7_745)); return $zd_dffa7_745; } public function HasMultiBytes($zd_36713_743) { if (function_exists('mb_strlen')) { return (strlen($zd_36713_743) > mb_strlen($zd_36713_743, $zd_a78c2_3->CharSet)); } else { return false; } } public function Base64EncodeWrapMB($zd_36713_743) { $zd_43220_833 = "=?".$zd_a78c2_3->CharSet."?B?"; $zd_5f6fa_835 = "?="; $zd_dffa7_745 = ""; $zd_6f3be_837 = mb_strlen($zd_36713_743, $zd_a78c2_3->CharSet); $zd_5215c_32 = 75 - strlen($zd_43220_833) - strlen($zd_5f6fa_835); $zd_4bffb_843 = $zd_6f3be_837 / strlen($zd_36713_743); $zd_04d58_846 = $zd_2a069_847 = floor($zd_5215c_32 * $zd_4bffb_843 * .75); for ($zd_cd386_51 = 0; $zd_cd386_51 < $zd_6f3be_837; $zd_cd386_51 += $zd_04d58_846) { $zd_4a3d4_149 = 0; do { $zd_04d58_846 = $zd_2a069_847 - $zd_4a3d4_149; $zd_f384f_859 = mb_substr($zd_36713_743, $zd_cd386_51, $zd_04d58_846, $zd_a78c2_3->CharSet); $zd_f384f_859 = base64_encode($zd_f384f_859); $zd_4a3d4_149++; } while (strlen($zd_f384f_859) > $zd_5215c_32); $zd_dffa7_745 .= $zd_f384f_859 . $zd_a78c2_3->LE; } $zd_dffa7_745 = substr($zd_dffa7_745, 0, -strlen($zd_a78c2_3->LE)); return $zd_dffa7_745; } public function EncodeQPphp( $zd_6b66e_876 = '', $zd_e370a_877 = 76, $zd_9a555_878 = false) { $zd_8afe2_159 = array('0', '1', '2', '3', '4', '5', '6', '7', '8', '9', 'A', 'B', 'C', 'D', 'E', 'F'); $zd_d2f7f_880 = preg_split('/(?:\r\n|\r|\n)/', $zd_6b66e_876); $zd_e81e6_882 = "\r\n"; $zd_544f1_883 = '='; $zd_b4877_884 = ''; foreach ($zd_d2f7f_880 as $zd_fce1f_47) { $zd_da111_887 = strlen($zd_fce1f_47); $zd_956d8_889 = ''; for($zd_cd386_51 = 0; $zd_cd386_51 < $zd_da111_887; $zd_cd386_51++) { $zd_d7b08_894 = substr( $zd_fce1f_47, $zd_cd386_51, 1 ); $zd_74b27_164 = ord( $zd_d7b08_894 ); if ( ( $zd_cd386_51 == 0 ) && ( $zd_74b27_164 == 46 ) ) { $zd_d7b08_894 = '=2E'; } if ( $zd_74b27_164 == 32 ) { if ( $zd_cd386_51 == ( $zd_da111_887 - 1 ) ) { $zd_d7b08_894 = '=20'; } else if ( $zd_9a555_878 ) { $zd_d7b08_894 = '=20'; } } elseif ( ($zd_74b27_164 == 61) || ($zd_74b27_164 < 32 ) || ($zd_74b27_164 > 126) ) { $zd_e61a0_911 = floor($zd_74b27_164/16); $zd_29332_913 = floor($zd_74b27_164%16); $zd_d7b08_894 = $zd_544f1_883.$zd_8afe2_159[$zd_e61a0_911].$zd_8afe2_159[$zd_29332_913]; } if ( (strlen($zd_956d8_889) + strlen($zd_d7b08_894)) >= $zd_e370a_877 ) { $zd_b4877_884 .= $zd_956d8_889.$zd_544f1_883.$zd_e81e6_882; $zd_956d8_889 = ''; if ( $zd_74b27_164 == 46 ) { $zd_d7b08_894 = '=2E'; } } $zd_956d8_889 .= $zd_d7b08_894; } $zd_b4877_884 .= $zd_956d8_889.$zd_e81e6_882; } return $zd_b4877_884; } public function EncodeQP($zd_1e915_652, $zd_e370a_877 = 76, $zd_9a555_878 = false) { if (function_exists('quoted_printable_encode')) { return quoted_printable_encode($zd_1e915_652); } $zd_fb782_941 = stream_get_filters(); if (!in_array('convert.*', $zd_fb782_941)) { return $zd_a78c2_3->EncodeQPphp($zd_1e915_652, $zd_e370a_877, $zd_9a555_878); } $zd_ba82f_947 = fopen('php://temp/', 'r+'); $zd_1e915_652 = preg_replace('/\r\n?/', $zd_a78c2_3->LE, $zd_1e915_652); $zd_c2aa7_951 = array('line-length' => $zd_e370a_877, 'line-break-chars' => $zd_a78c2_3->LE); $zd_f8b61_954 = stream_filter_append($zd_ba82f_947, 'convert.quoted-printable-encode', STREAM_FILTER_READ, $zd_c2aa7_951); fputs($zd_ba82f_947, $zd_1e915_652); rewind($zd_ba82f_947); $zd_ee503_960 = stream_get_contents($zd_ba82f_947); stream_filter_remove($zd_f8b61_954); $zd_ee503_960 = preg_replace('/^\./m', '=2E', $zd_ee503_960); fclose($zd_ba82f_947); return $zd_ee503_960; } public function EncodeQ($zd_36713_743, $zd_14f31_768 = 'text') { $zd_dffa7_745 = preg_replace('/[\r\n]*/', '', $zd_36713_743); switch (strtolower($zd_14f31_768)) { case 'phrase': $zd_dffa7_745 = preg_replace_callback("/([^A-Za-z0-9!*+\/ -])/", array($zd_a78c2_3, 'sprintf_1_callback'), $zd_dffa7_745); break; case 'comment': $zd_dffa7_745 = preg_replace_callback("/([\(\)\"])/", array($zd_a78c2_3, 'sprintf_1_callback'), $zd_dffa7_745); case 'text': default: $zd_dffa7_745 = preg_replace_callback('/([\000-\011\013\014\016-\037\075\077\137\177-\377])/', array($zd_a78c2_3, 'sprintf_2_callback'), $zd_dffa7_745); break; } $zd_dffa7_745 = str_replace(' ', '_', $zd_dffa7_745); return $zd_dffa7_745; } private function sprintf_1_callback($zd_d7fab_984) { return '='.sprintf('%02X', ord($zd_d7fab_984[1])); } private function sprintf_2_callback($zd_d7fab_984) { return '='.sprintf('%02X', ord(stripslashes($zd_d7fab_984[1]))); } public function AddStringAttachment($zd_1e915_652, $zd_acb81_620, $zd_e49ef_565 = 'base64', $zd_a7299_7 = 'application/octet-stream') { $zd_a78c2_3->attachment[] = array( 0 => $zd_1e915_652, 1 => $zd_acb81_620, 2 => basename($zd_acb81_620), 3 => $zd_e49ef_565, 4 => $zd_a7299_7, 5 => true, 6 => 'attachment', 7 => 0 ); } public function AddEmbeddedImage($zd_21706_613, $zd_a566b_672, $zd_3a271_605 = '', $zd_e49ef_565 = 'base64', $zd_a7299_7 = 'application/octet-stream') { if ( !@is_file($zd_21706_613) ) { $zd_a78c2_3->SetError($zd_a78c2_3->Lang('file_access') . $zd_21706_613); return false; } $zd_acb81_620 = basename($zd_21706_613); if ( $zd_3a271_605 == '' ) { $zd_3a271_605 = $zd_acb81_620; } $zd_a78c2_3->attachment[] = array( 0 => $zd_21706_613, 1 => $zd_acb81_620, 2 => $zd_3a271_605, 3 => $zd_e49ef_565, 4 => $zd_a7299_7, 5 => false, 6 => 'inline', 7 => $zd_a566b_672 ); return true; } public function AddStringEmbeddedImage($zd_1e915_652, $zd_a566b_672, $zd_acb81_620 = '', $zd_e49ef_565 = 'base64', $zd_a7299_7 = 'application/octet-stream') { $zd_a78c2_3->attachment[] = array( 0 => $zd_1e915_652, 1 => $zd_acb81_620, 2 => basename($zd_acb81_620), 3 => $zd_e49ef_565, 4 => $zd_a7299_7, 5 => true, 6 => 'inline', 7 => $zd_a566b_672 ); } public function InlineImageExists() { foreach($zd_a78c2_3->attachment as $zd_ae367_646) { if ($zd_ae367_646[6] == 'inline') { return true; } } return false; } public function AttachmentExists() { foreach($zd_a78c2_3->attachment as $zd_ae367_646) { if ($zd_ae367_646[6] == 'attachment') { return true; } } return false; } public function AlternativeExists() { return strlen($zd_a78c2_3->AltBody)>0; } public function ClearAddresses() { foreach($zd_a78c2_3->to as $zd_29a46_1039) { unset($zd_a78c2_3->all_recipients[strtolower($zd_29a46_1039[0])]); } $zd_a78c2_3->to = array(); } public function ClearCCs() { foreach($zd_a78c2_3->cc as $zd_d02fc_1044) { unset($zd_a78c2_3->all_recipients[strtolower($zd_d02fc_1044[0])]); } $zd_a78c2_3->cc = array(); } public function ClearBCCs() { foreach($zd_a78c2_3->bcc as $zd_98b7f_1049) { unset($zd_a78c2_3->all_recipients[strtolower($zd_98b7f_1049[0])]); } $zd_a78c2_3->bcc = array(); } public function ClearReplyTos() { $zd_a78c2_3->ReplyTo = array(); } public function ClearAllRecipients() { $zd_a78c2_3->to = array(); $zd_a78c2_3->cc = array(); $zd_a78c2_3->bcc = array(); $zd_a78c2_3->all_recipients = array(); } public function ClearAttachments() { $zd_a78c2_3->attachment = array(); } public function ClearCustomHeaders() { $zd_a78c2_3->CustomHeader = array(); } protected function SetError($zd_e3e42_1060) { $zd_a78c2_3->error_count++; if ($zd_a78c2_3->Mailer == 'smtp' and !is_null($zd_a78c2_3->smtp)) { $zd_c3b01_1064 = $zd_a78c2_3->smtp->getError(); if (!empty($zd_c3b01_1064) and array_key_exists('smtp_msg', $zd_c3b01_1064)) { $zd_e3e42_1060 .= '<p>' . $zd_a78c2_3->Lang('smtp_error') . $zd_c3b01_1064['smtp_msg'] . "</p>\n"; } } $zd_a78c2_3->ErrorInfo = $zd_e3e42_1060; } public static function RFCDate() { $zd_f1c32_1073 = date('Z'); $zd_15309_1074 = ($zd_f1c32_1073 < 0) ? '-' : '+'; $zd_f1c32_1073 = abs($zd_f1c32_1073); $zd_f1c32_1073 = (int)($zd_f1c32_1073/3600)*100 + ($zd_f1c32_1073%3600)/60; $zd_9cdd6_194 = sprintf("%s %s%04d", date('D, j M Y H:i:s'), $zd_15309_1074, $zd_f1c32_1073); return $zd_9cdd6_194; } protected function ServerHostname() { if (!empty($zd_a78c2_3->Hostname)) { $zd_9cdd6_194 = $zd_a78c2_3->Hostname; } elseif (isset($_SERVER['SERVER_NAME'])) { $zd_9cdd6_194 = $_SERVER['SERVER_NAME']; } else { $zd_9cdd6_194 = 'localhost.localdomain'; } return $zd_9cdd6_194; } protected function Lang($zd_8186c_1091) { if(count($zd_a78c2_3->language) < 1) { $zd_a78c2_3->SetLanguage('en'); } if(isset($zd_a78c2_3->language[$zd_8186c_1091])) { return $zd_a78c2_3->language[$zd_8186c_1091]; } else { return 'Language string failed to load: ' . $zd_8186c_1091; } } public function IsError() { return ($zd_a78c2_3->error_count > 0); } public function FixEOL($zd_36713_743) { $zd_36713_743 = str_replace("\r\n", "\n", $zd_36713_743); $zd_36713_743 = str_replace("\r", "\n", $zd_36713_743); $zd_36713_743 = str_replace("\n", $zd_a78c2_3->LE, $zd_36713_743); return $zd_36713_743; } public function AddCustomHeader($zd_2d9eb_1109) { $zd_a78c2_3->CustomHeader[] = explode(':', $zd_2d9eb_1109, 2); } public function MsgHTML($zd_c767f_31, $zd_82d87_1113 = '') { preg_match_all("/(src|background)=[\"'](.*)[\"']/Ui", $zd_c767f_31, $zd_6c67d_1115); if(isset($zd_6c67d_1115[2])) { foreach($zd_6c67d_1115[2] as $zd_cd386_51 => $zd_ab1f0_1119) { if (!preg_match('#^[A-z]+://#', $zd_ab1f0_1119)) { $zd_acb81_620 = basename($zd_ab1f0_1119); $zd_622e1_1123 = dirname($zd_ab1f0_1119); ($zd_622e1_1123 == '.') ? $zd_622e1_1123='': ''; $zd_a566b_672 = 'cid:' . md5($zd_acb81_620); $zd_e55d5_1129 = pathinfo($zd_acb81_620, PATHINFO_EXTENSION); $zd_cf3b4_1131 = self::_mime_types($zd_e55d5_1129); if ( strlen($zd_82d87_1113) > 1 && substr($zd_82d87_1113, -1) != '/') { $zd_82d87_1113 .= '/'; } if ( strlen($zd_622e1_1123) > 1 && substr($zd_622e1_1123, -1) != '/') { $zd_622e1_1123 .= '/'; } if ( $zd_a78c2_3->AddEmbeddedImage($zd_82d87_1113.$zd_622e1_1123.$zd_acb81_620, md5($zd_acb81_620), $zd_acb81_620, 'base64', $zd_cf3b4_1131) ) { $zd_c767f_31 = preg_replace("/".$zd_6c67d_1115[1][$zd_cd386_51]."=[\"']".preg_quote($zd_ab1f0_1119, '/')."[\"']/Ui", $zd_6c67d_1115[1][$zd_cd386_51]."=\"".$zd_a566b_672."\"", $zd_c767f_31); } } } } $zd_a78c2_3->IsHTML(true); $zd_a78c2_3->Body = $zd_c767f_31; if (empty($zd_a78c2_3->AltBody)) { $zd_06913_1158 = trim(strip_tags(preg_replace('/<(head|title|style|script)[^>]*>.*?<\/\\1>/s', '', $zd_c767f_31))); if (!empty($zd_06913_1158)) { $zd_a78c2_3->AltBody = html_entity_decode($zd_06913_1158, ENT_QUOTES, $zd_a78c2_3->CharSet); } } if (empty($zd_a78c2_3->AltBody)) { $zd_a78c2_3->AltBody = 'To view this email message, open it in a program that understands HTML!' . "\n\n"; } return $zd_c767f_31; } public static function _mime_types($zd_e55d5_1129 = '') { $zd_09ea5_1168 = array( 'hqx' => 'application/mac-binhex40', 'cpt' => 'application/mac-compactpro', 'doc' => 'application/msword', 'bin' => 'application/macbinary', 'dms' => 'application/octet-stream', 'lha' => 'application/octet-stream', 'lzh' => 'application/octet-stream', 'exe' => 'application/octet-stream', 'class' => 'application/octet-stream', 'psd' => 'application/octet-stream', 'so' => 'application/octet-stream', 'sea' => 'application/octet-stream', 'dll' => 'application/octet-stream', 'oda' => 'application/oda', 'pdf' => 'application/pdf', 'ai' => 'application/postscript', 'eps' => 'application/postscript', 'ps' => 'application/postscript', 'smi' => 'application/smil', 'smil' => 'application/smil', 'mif' => 'application/vnd.mif', 'xls' => 'application/vnd.ms-excel', 'ppt' => 'application/vnd.ms-powerpoint', 'wbxml' => 'application/vnd.wap.wbxml', 'wmlc' => 'application/vnd.wap.wmlc', 'dcr' => 'application/x-director', 'dir' => 'application/x-director', 'dxr' => 'application/x-director', 'dvi' => 'application/x-dvi', 'gtar' => 'application/x-gtar', 'php' => 'application/x-httpd-php', 'php4' => 'application/x-httpd-php', 'php3' => 'application/x-httpd-php', 'phtml' => 'application/x-httpd-php', 'phps' => 'application/x-httpd-php-source', 'js' => 'application/x-javascript', 'swf' => 'application/x-shockwave-flash', 'sit' => 'application/x-stuffit', 'tar' => 'application/x-tar', 'tgz' => 'application/x-tar', 'xhtml' => 'application/xhtml+xml', 'xht' => 'application/xhtml+xml', 'zip' => 'application/zip', 'mid' => 'audio/midi', 'midi' => 'audio/midi', 'mpga' => 'audio/mpeg', 'mp2' => 'audio/mpeg', 'mp3' => 'audio/mpeg', 'aif' => 'audio/x-aiff', 'aiff' => 'audio/x-aiff', 'aifc' => 'audio/x-aiff', 'ram' => 'audio/x-pn-realaudio', 'rm' => 'audio/x-pn-realaudio', 'rpm' => 'audio/x-pn-realaudio-plugin', 'ra' => 'audio/x-realaudio', 'rv' => 'video/vnd.rn-realvideo', 'wav' => 'audio/x-wav', 'bmp' => 'image/bmp', 'gif' => 'image/gif', 'jpeg' => 'image/jpeg', 'jpg' => 'image/jpeg', 'jpe' => 'image/jpeg', 'png' => 'image/png', 'tiff' => 'image/tiff', 'tif' => 'image/tiff', 'css' => 'text/css', 'html' => 'text/html', 'htm' => 'text/html', 'shtml' => 'text/html', 'txt' => 'text/plain', 'text' => 'text/plain', 'log' => 'text/plain', 'rtx' => 'text/richtext', 'rtf' => 'text/rtf', 'xml' => 'text/xml', 'xsl' => 'text/xml', 'mpeg' => 'video/mpeg', 'mpg' => 'video/mpeg', 'mpe' => 'video/mpeg', 'qt' => 'video/quicktime', 'mov' => 'video/quicktime', 'avi' => 'video/x-msvideo', 'movie' => 'video/x-sgi-movie', 'doc' => 'application/msword', 'word' => 'application/msword', 'xl' => 'application/excel', 'eml' => 'message/rfc822' ); return (!isset($zd_09ea5_1168[strtolower($zd_e55d5_1129)])) ? 'application/octet-stream' : $zd_09ea5_1168[strtolower($zd_e55d5_1129)]; } public function set($zd_3a271_605, $zd_1727e_606 = '') { try { if (isset($zd_a78c2_3->$zd_3a271_605) ) { $zd_a78c2_3->$zd_3a271_605 = $zd_1727e_606; } else { throw new phpmailerException($zd_a78c2_3->Lang('variable_set') . $zd_3a271_605, self::STOP_CRITICAL); } } catch (Exception $zd_a0502_59) { $zd_a78c2_3->SetError($zd_a0502_59->getMessage()); if ($zd_a0502_59->getCode() == self::STOP_CRITICAL) { return false; } } return true; } public function SecureHeader($zd_36713_743) { $zd_36713_743 = str_replace("\r", '', $zd_36713_743); $zd_36713_743 = str_replace("\n", '', $zd_36713_743); return trim($zd_36713_743); } public function Sign($zd_e68d5_1192, $zd_7b24b_1193, $zd_849d4_1194) { $zd_a78c2_3->sign_cert_file = $zd_e68d5_1192; $zd_a78c2_3->sign_key_file = $zd_7b24b_1193; $zd_a78c2_3->sign_key_pass = $zd_849d4_1194; } public function DKIM_QP($zd_c7720_1201) { $zd_8bc9e_1202 = ''; $zd_fce1f_47 = ''; for ($zd_cd386_51 = 0; $zd_cd386_51 < strlen($zd_c7720_1201); $zd_cd386_51++) { $zd_a03e4_1208 = ord($zd_c7720_1201[$zd_cd386_51]); if ( ((0x21 <= $zd_a03e4_1208) && ($zd_a03e4_1208 <= 0x3A)) || $zd_a03e4_1208 == 0x3C || ((0x3E <= $zd_a03e4_1208) && ($zd_a03e4_1208 <= 0x7E)) ) { $zd_fce1f_47 .= $zd_c7720_1201[$zd_cd386_51]; } else { $zd_fce1f_47 .= "=".sprintf("%02X", $zd_a03e4_1208); } } return $zd_fce1f_47; } public function DKIM_Sign($zd_f8b61_954) { $zd_a58ad_1223 = file_get_contents($zd_a78c2_3->DKIM_private); if ($zd_a78c2_3->DKIM_passphrase != '') { $zd_a0bef_1226 = openssl_pkey_get_private($zd_a58ad_1223, $zd_a78c2_3->DKIM_passphrase); } else { $zd_a0bef_1226 = $zd_a58ad_1223; } if (openssl_sign($zd_f8b61_954, $zd_ac0a2_1232, $zd_a0bef_1226)) { return base64_encode($zd_ac0a2_1232); } } public function DKIM_HeaderC($zd_f8b61_954) { $zd_f8b61_954 = preg_replace("/\r\n\s+/", " ", $zd_f8b61_954); $zd_d2f7f_880 = explode("\r\n", $zd_f8b61_954); foreach ($zd_d2f7f_880 as $zd_8186c_1091 => $zd_fce1f_47) { list($zd_7edc7_1243, $zd_1727e_606) = explode(":", $zd_fce1f_47, 2); $zd_7edc7_1243 = strtolower($zd_7edc7_1243); $zd_1727e_606 = preg_replace("/\s+/", " ", $zd_1727e_606) ; $zd_d2f7f_880[$zd_8186c_1091] = $zd_7edc7_1243.":".trim($zd_1727e_606) ; } $zd_f8b61_954 = implode("\r\n", $zd_d2f7f_880); return $zd_f8b61_954; } public function DKIM_BodyC($zd_59d22_322) { if ($zd_59d22_322 == '') return "\r\n"; $zd_59d22_322 = str_replace("\r\n", "\n", $zd_59d22_322); $zd_59d22_322 = str_replace("\n", "\r\n", $zd_59d22_322); while (substr($zd_59d22_322, strlen($zd_59d22_322) - 4, 4) == "\r\n\r\n") { $zd_59d22_322 = substr($zd_59d22_322, 0, strlen($zd_59d22_322) - 2); } return $zd_59d22_322; } public function DKIM_Add($zd_422a2_1269, $zd_a56e2_1270, $zd_59d22_322) { $zd_26c5d_1272 = 'rsa-sha1'; $zd_ee7d5_1273 = 'relaxed/simple'; $zd_ec9cb_1274 = 'dns/txt'; $zd_0f4e9_1275 = time() ; $zd_db500_1276 = "Subject: $zd_a56e2_1270"; $zd_b0290_1278 = explode($zd_a78c2_3->LE, $zd_422a2_1269); foreach($zd_b0290_1278 as $zd_55648_1282) { if (strpos($zd_55648_1282, 'From:') === 0) { $zd_3b3d0_1284 = $zd_55648_1282; } elseif (strpos($zd_55648_1282, 'To:') === 0) { $zd_9aee5_1287 = $zd_55648_1282; } } $zd_5d2cb_225 = str_replace('|', '=7C', $zd_a78c2_3->DKIM_QP($zd_3b3d0_1284)); $zd_29a46_1039 = str_replace('|', '=7C', $zd_a78c2_3->DKIM_QP($zd_9aee5_1287)); $zd_a56e2_1270 = str_replace('|', '=7C', $zd_a78c2_3->DKIM_QP($zd_db500_1276)) ; $zd_59d22_322 = $zd_a78c2_3->DKIM_BodyC($zd_59d22_322); $zd_a442d_1301 = strlen($zd_59d22_322) ; $zd_de9f8_1303 = base64_encode(pack("H*", sha1($zd_59d22_322))) ; $zd_65a8a_1305 = ($zd_a78c2_3->DKIM_identity == '')? '' : " i=" . $zd_a78c2_3->DKIM_identity . ";"; $zd_efeb5_1308 = "DKIM-Signature: v=1; a=" . $zd_26c5d_1272 . "; q=" . $zd_ec9cb_1274 . "; l=" . $zd_a442d_1301 . "; s=" . $zd_a78c2_3->DKIM_selector . ";\r\n". "\tt=" . $zd_0f4e9_1275 . "; c=" . $zd_ee7d5_1273 . ";\r\n". "\th=From:To:Subject;\r\n". "\td=" . $zd_a78c2_3->DKIM_domain . ";" . $zd_65a8a_1305 . "\r\n". "\tz=$zd_5d2cb_225\r\n". "\t|$zd_29a46_1039\r\n". "\t|$zd_a56e2_1270;\r\n". "\tbh=" . $zd_de9f8_1303 . ";\r\n". "\tb="; $zd_85e79_1321 = $zd_a78c2_3->DKIM_HeaderC($zd_3b3d0_1284 . "\r\n" . $zd_9aee5_1287 . "\r\n" . $zd_db500_1276 . "\r\n" . $zd_efeb5_1308); $zd_bd3b1_544 = $zd_a78c2_3->DKIM_Sign($zd_85e79_1321); return "X-PHPMAILER-DKIM: phpmailer.worxware.com\r\n".$zd_efeb5_1308.$zd_bd3b1_544."\r\n"; } protected function doCallback($zd_1c289_1332, $zd_29a46_1039, $zd_d02fc_1044, $zd_98b7f_1049, $zd_a56e2_1270, $zd_59d22_322) { if (!empty($zd_a78c2_3->action_function) && function_exists($zd_a78c2_3->action_function)) { $zd_c2aa7_951 = array($zd_1c289_1332, $zd_29a46_1039, $zd_d02fc_1044, $zd_98b7f_1049, $zd_a56e2_1270, $zd_59d22_322); call_user_func_array($zd_a78c2_3->action_function, $zd_c2aa7_951); } } } class phpmailerException extends Exception { public function errorMessage() { $zd_6ebf1_1349 = '<strong>' . $zd_a78c2_3->getMessage() . "</strong><br />\n"; return $zd_6ebf1_1349; } } class SMTP { public $zd_6c237_1352 = 25; public $zd_17e1f_1353 = "\r\n"; public $zd_70183_1354; public $zd_4cf7b_1355 = false; public $zd_9549c_1356 = '5.2.1'; private $zd_9460f_1357; private $zd_5cba8_1358; private $zd_df8b4_1359; public function __construct() { $zd_a78c2_3->smtp_conn = 0; $zd_a78c2_3->error = null; $zd_a78c2_3->helo_rply = null; $zd_a78c2_3->do_debug = 0; } public function Connect($zd_6d0cf_1364, $zd_1f066_1365 = 0, $zd_68a84_1366 = 5) { $zd_a78c2_3->error = null; if($zd_a78c2_3->connected()) { $zd_a78c2_3->error = array("error" => "Already connected to a server"); return false; } if(empty($zd_1f066_1365)) { $zd_1f066_1365 = $zd_a78c2_3->SMTP_PORT; } $zd_cedd7_1373 = 0; $zd_dfa1f_1374 = ''; $zd_a78c2_3->smtp_conn = @fsockopen($zd_6d0cf_1364, $zd_1f066_1365, $zd_cedd7_1373, $zd_dfa1f_1374, $zd_68a84_1366); if(empty($zd_a78c2_3->smtp_conn)) { $zd_a78c2_3->error = array("error" => "Failed to connect to server", "errno" => $zd_cedd7_1373, "errstr" => $zd_dfa1f_1374); if($zd_a78c2_3->do_debug >= 1) { echo "SMTP -> ERROR: " . $zd_a78c2_3->error["error"] . ": $zd_dfa1f_1374 ($zd_cedd7_1373)" . $zd_a78c2_3->CRLF . '<br />'; } return false; } if(substr(PHP_OS, 0, 3) != "WIN") socket_set_timeout($zd_a78c2_3->smtp_conn, $zd_68a84_1366, 0); $zd_cbc22_1392 = $zd_a78c2_3->get_lines(); if($zd_a78c2_3->do_debug >= 2) { echo "SMTP -> FROM SERVER:" . $zd_cbc22_1392 . $zd_a78c2_3->CRLF . '<br />'; } return true; } public function StartTLS() { $zd_a78c2_3->error = null; if(!$zd_a78c2_3->connected()) { $zd_a78c2_3->error = array("error" => "Called StartTLS() without being connected"); return false; } fputs($zd_a78c2_3->smtp_conn,"STARTTLS" . $zd_a78c2_3->CRLF); $zd_d4cfb_1402 = $zd_a78c2_3->get_lines(); $zd_abfe6_1404 = substr($zd_d4cfb_1402,0,3); if($zd_a78c2_3->do_debug >= 2) { echo "SMTP -> FROM SERVER:" . $zd_d4cfb_1402 . $zd_a78c2_3->CRLF . '<br />'; } if($zd_abfe6_1404 != 220) { $zd_a78c2_3->error = array("error" => "STARTTLS not accepted from server", "smtp_code" => $zd_abfe6_1404, "smtp_msg" => substr($zd_d4cfb_1402,4)); if($zd_a78c2_3->do_debug >= 1) { echo "SMTP -> ERROR: " . $zd_a78c2_3->error["error"] . ": " . $zd_d4cfb_1402 . $zd_a78c2_3->CRLF . '<br />'; } return false; } if(!stream_socket_enable_crypto($zd_a78c2_3->smtp_conn, true, STREAM_CRYPTO_METHOD_TLS_CLIENT)) { return false; } return true; } public function Authenticate($zd_04121_1418, $zd_8d2ce_1419) { fputs($zd_a78c2_3->smtp_conn,"AUTH LOGIN" . $zd_a78c2_3->CRLF); $zd_d4cfb_1402 = $zd_a78c2_3->get_lines(); $zd_abfe6_1404 = substr($zd_d4cfb_1402,0,3); if($zd_abfe6_1404 != 334) { $zd_a78c2_3->error = array("error" => "AUTH not accepted from server", "smtp_code" => $zd_abfe6_1404, "smtp_msg" => substr($zd_d4cfb_1402,4)); if($zd_a78c2_3->do_debug >= 1) { echo "SMTP -> ERROR: " . $zd_a78c2_3->error["error"] . ": " . $zd_d4cfb_1402 . $zd_a78c2_3->CRLF . '<br />'; } return false; } fputs($zd_a78c2_3->smtp_conn, base64_encode($zd_04121_1418) . $zd_a78c2_3->CRLF); $zd_d4cfb_1402 = $zd_a78c2_3->get_lines(); $zd_abfe6_1404 = substr($zd_d4cfb_1402,0,3); if($zd_abfe6_1404 != 334) { $zd_a78c2_3->error = array("error" => "Username not accepted from server", "smtp_code" => $zd_abfe6_1404, "smtp_msg" => substr($zd_d4cfb_1402,4)); if($zd_a78c2_3->do_debug >= 1) { echo "SMTP -> ERROR: " . $zd_a78c2_3->error["error"] . ": " . $zd_d4cfb_1402 . $zd_a78c2_3->CRLF . '<br />'; } return false; } fputs($zd_a78c2_3->smtp_conn, base64_encode($zd_8d2ce_1419) . $zd_a78c2_3->CRLF); $zd_d4cfb_1402 = $zd_a78c2_3->get_lines(); $zd_abfe6_1404 = substr($zd_d4cfb_1402,0,3); if($zd_abfe6_1404 != 235) { $zd_a78c2_3->error = array("error" => "Password not accepted from server", "smtp_code" => $zd_abfe6_1404, "smtp_msg" => substr($zd_d4cfb_1402,4)); if($zd_a78c2_3->do_debug >= 1) { echo "SMTP -> ERROR: " . $zd_a78c2_3->error["error"] . ": " . $zd_d4cfb_1402 . $zd_a78c2_3->CRLF . '<br />'; } return false; } return true; } public function Connected() { if(!empty($zd_a78c2_3->smtp_conn)) { $zd_a5ae5_1465 = socket_get_status($zd_a78c2_3->smtp_conn); if($zd_a5ae5_1465["eof"]) { if($zd_a78c2_3->do_debug >= 1) { echo "SMTP -> NOTICE:" . $zd_a78c2_3->CRLF . "EOF caught while checking if connected"; } $zd_a78c2_3->Close(); return false; } return true; } return false; } public function Close() { $zd_a78c2_3->error = null; $zd_a78c2_3->helo_rply = null; if(!empty($zd_a78c2_3->smtp_conn)) { fclose($zd_a78c2_3->smtp_conn); $zd_a78c2_3->smtp_conn = 0; } } public function Data($zd_9263e_1476) { $zd_a78c2_3->error = null; if(!$zd_a78c2_3->connected()) { $zd_a78c2_3->error = array( "error" => "Called Data() without being connected"); return false; } fputs($zd_a78c2_3->smtp_conn,"DATA" . $zd_a78c2_3->CRLF); $zd_d4cfb_1402 = $zd_a78c2_3->get_lines(); $zd_abfe6_1404 = substr($zd_d4cfb_1402,0,3); if($zd_a78c2_3->do_debug >= 2) { echo "SMTP -> FROM SERVER:" . $zd_d4cfb_1402 . $zd_a78c2_3->CRLF . '<br />'; } if($zd_abfe6_1404 != 354) { $zd_a78c2_3->error = array("error" => "DATA command not accepted from server", "smtp_code" => $zd_abfe6_1404, "smtp_msg" => substr($zd_d4cfb_1402,4)); if($zd_a78c2_3->do_debug >= 1) { echo "SMTP -> ERROR: " . $zd_a78c2_3->error["error"] . ": " . $zd_d4cfb_1402 . $zd_a78c2_3->CRLF . '<br />'; } return false; } $zd_9263e_1476 = str_replace("\r\n","\n",$zd_9263e_1476); $zd_9263e_1476 = str_replace("\r","\n",$zd_9263e_1476); $zd_d2f7f_880 = explode("\n",$zd_9263e_1476); $zd_b576c_1503 = substr($zd_d2f7f_880[0],0,strpos($zd_d2f7f_880[0],":")); $zd_3d41b_1506 = false; if(!empty($zd_b576c_1503) && !strstr($zd_b576c_1503," ")) { $zd_3d41b_1506 = true; } $zd_8353b_1510 = 998; foreach ($zd_d2f7f_880 as $zd_fce1f_47) { $zd_14900_1513 = null; if($zd_fce1f_47 == "" && $zd_3d41b_1506) { $zd_3d41b_1506 = false; } while(strlen($zd_fce1f_47) > $zd_8353b_1510) { $zd_5acd4_1519 = strrpos(substr($zd_fce1f_47,0,$zd_8353b_1510)," "); if(!$zd_5acd4_1519) { $zd_5acd4_1519 = $zd_8353b_1510 - 1; $zd_14900_1513[] = substr($zd_fce1f_47,0,$zd_5acd4_1519); $zd_fce1f_47 = substr($zd_fce1f_47,$zd_5acd4_1519); } else { $zd_14900_1513[] = substr($zd_fce1f_47,0,$zd_5acd4_1519); $zd_fce1f_47 = substr($zd_fce1f_47,$zd_5acd4_1519 + 1); } if($zd_3d41b_1506) { $zd_fce1f_47 = "\t" . $zd_fce1f_47; } } $zd_14900_1513[] = $zd_fce1f_47; foreach ($zd_14900_1513 as $zd_b52e1_1543) { if(strlen($zd_b52e1_1543) > 0) { if(substr($zd_b52e1_1543, 0, 1) == ".") { $zd_b52e1_1543 = "." . $zd_b52e1_1543; } } fputs($zd_a78c2_3->smtp_conn,$zd_b52e1_1543 . $zd_a78c2_3->CRLF); } } fputs($zd_a78c2_3->smtp_conn, $zd_a78c2_3->CRLF . "." . $zd_a78c2_3->CRLF); $zd_d4cfb_1402 = $zd_a78c2_3->get_lines(); $zd_abfe6_1404 = substr($zd_d4cfb_1402,0,3); if($zd_a78c2_3->do_debug >= 2) { echo "SMTP -> FROM SERVER:" . $zd_d4cfb_1402 . $zd_a78c2_3->CRLF . '<br />'; } if($zd_abfe6_1404 != 250) { $zd_a78c2_3->error = array("error" => "DATA not accepted from server", "smtp_code" => $zd_abfe6_1404, "smtp_msg" => substr($zd_d4cfb_1402,4)); if($zd_a78c2_3->do_debug >= 1) { echo "SMTP -> ERROR: " . $zd_a78c2_3->error["error"] . ": " . $zd_d4cfb_1402 . $zd_a78c2_3->CRLF . '<br />'; } return false; } return true; } public function Hello($zd_6d0cf_1364 = '') { $zd_a78c2_3->error = null; if(!$zd_a78c2_3->connected()) { $zd_a78c2_3->error = array( "error" => "Called Hello() without being connected"); return false; } if(empty($zd_6d0cf_1364)) { $zd_6d0cf_1364 = "localhost"; } if(!$zd_a78c2_3->SendHello("EHLO", $zd_6d0cf_1364)) { if(!$zd_a78c2_3->SendHello("HELO", $zd_6d0cf_1364)) { return false; } } return true; } private function SendHello($zd_c8341_1579, $zd_6d0cf_1364) { fputs($zd_a78c2_3->smtp_conn, $zd_c8341_1579 . " " . $zd_6d0cf_1364 . $zd_a78c2_3->CRLF); $zd_d4cfb_1402 = $zd_a78c2_3->get_lines(); $zd_abfe6_1404 = substr($zd_d4cfb_1402,0,3); if($zd_a78c2_3->do_debug >= 2) { echo "SMTP -> FROM SERVER: " . $zd_d4cfb_1402 . $zd_a78c2_3->CRLF . '<br />'; } if($zd_abfe6_1404 != 250) { $zd_a78c2_3->error = array("error" => $zd_c8341_1579 . " not accepted from server", "smtp_code" => $zd_abfe6_1404, "smtp_msg" => substr($zd_d4cfb_1402,4)); if($zd_a78c2_3->do_debug >= 1) { echo "SMTP -> ERROR: " . $zd_a78c2_3->error["error"] . ": " . $zd_d4cfb_1402 . $zd_a78c2_3->CRLF . '<br />'; } return false; } $zd_a78c2_3->helo_rply = $zd_d4cfb_1402; return true; } public function Mail($zd_5d2cb_225) { $zd_a78c2_3->error = null; if(!$zd_a78c2_3->connected()) { $zd_a78c2_3->error = array( "error" => "Called Mail() without being connected"); return false; } $zd_200ce_1607 = ($zd_a78c2_3->do_verp ? "XVERP" : ""); fputs($zd_a78c2_3->smtp_conn,"MAIL FROM:<" . $zd_5d2cb_225 . ">" . $zd_200ce_1607 . $zd_a78c2_3->CRLF); $zd_d4cfb_1402 = $zd_a78c2_3->get_lines(); $zd_abfe6_1404 = substr($zd_d4cfb_1402,0,3); if($zd_a78c2_3->do_debug >= 2) { echo "SMTP -> FROM SERVER:" . $zd_d4cfb_1402 . $zd_a78c2_3->CRLF . '<br />'; } if($zd_abfe6_1404 != 250) { $zd_a78c2_3->error = array("error" => "MAIL not accepted from server", "smtp_code" => $zd_abfe6_1404, "smtp_msg" => substr($zd_d4cfb_1402,4)); if($zd_a78c2_3->do_debug >= 1) { echo "SMTP -> ERROR: " . $zd_a78c2_3->error["error"] . ": " . $zd_d4cfb_1402 . $zd_a78c2_3->CRLF . '<br />'; } return false; } return true; } public function Quit($zd_6bb36_1628 = true) { $zd_a78c2_3->error = null; if(!$zd_a78c2_3->connected()) { $zd_a78c2_3->error = array( "error" => "Called Quit() without being connected"); return false; } fputs($zd_a78c2_3->smtp_conn,"quit" . $zd_a78c2_3->CRLF); $zd_d8ffe_1634 = $zd_a78c2_3->get_lines(); if($zd_a78c2_3->do_debug >= 2) { echo "SMTP -> FROM SERVER:" . $zd_d8ffe_1634 . $zd_a78c2_3->CRLF . '<br />'; } $zd_e7100_1639 = true; $zd_a0502_59 = null; $zd_abfe6_1404 = substr($zd_d8ffe_1634,0,3); if($zd_abfe6_1404 != 221) { $zd_a0502_59 = array("error" => "SMTP server rejected quit command", "smtp_code" => $zd_abfe6_1404, "smtp_rply" => substr($zd_d8ffe_1634,4)); $zd_e7100_1639 = false; if($zd_a78c2_3->do_debug >= 1) { echo "SMTP -> ERROR: " . $zd_a0502_59["error"] . ": " . $zd_d8ffe_1634 . $zd_a78c2_3->CRLF . '<br />'; } } if(empty($zd_a0502_59) || $zd_6bb36_1628) { $zd_a78c2_3->Close(); } return $zd_e7100_1639; } public function Recipient($zd_29a46_1039) { $zd_a78c2_3->error = null; if(!$zd_a78c2_3->connected()) { $zd_a78c2_3->error = array( "error" => "Called Recipient() without being connected"); return false; } fputs($zd_a78c2_3->smtp_conn,"RCPT TO:<" . $zd_29a46_1039 . ">" . $zd_a78c2_3->CRLF); $zd_d4cfb_1402 = $zd_a78c2_3->get_lines(); $zd_abfe6_1404 = substr($zd_d4cfb_1402,0,3); if($zd_a78c2_3->do_debug >= 2) { echo "SMTP -> FROM SERVER:" . $zd_d4cfb_1402 . $zd_a78c2_3->CRLF . '<br />'; } if($zd_abfe6_1404 != 250 && $zd_abfe6_1404 != 251) { $zd_a78c2_3->error = array("error" => "RCPT not accepted from server", "smtp_code" => $zd_abfe6_1404, "smtp_msg" => substr($zd_d4cfb_1402,4)); if($zd_a78c2_3->do_debug >= 1) { echo "SMTP -> ERROR: " . $zd_a78c2_3->error["error"] . ": " . $zd_d4cfb_1402 . $zd_a78c2_3->CRLF . '<br />'; } return false; } return true; } public function Reset() { $zd_a78c2_3->error = null; if(!$zd_a78c2_3->connected()) { $zd_a78c2_3->error = array( "error" => "Called Reset() without being connected"); return false; } fputs($zd_a78c2_3->smtp_conn,"RSET" . $zd_a78c2_3->CRLF); $zd_d4cfb_1402 = $zd_a78c2_3->get_lines(); $zd_abfe6_1404 = substr($zd_d4cfb_1402,0,3); if($zd_a78c2_3->do_debug >= 2) { echo "SMTP -> FROM SERVER:" . $zd_d4cfb_1402 . $zd_a78c2_3->CRLF . '<br />'; } if($zd_abfe6_1404 != 250) { $zd_a78c2_3->error = array("error" => "RSET failed", "smtp_code" => $zd_abfe6_1404, "smtp_msg" => substr($zd_d4cfb_1402,4)); if($zd_a78c2_3->do_debug >= 1) { echo "SMTP -> ERROR: " . $zd_a78c2_3->error["error"] . ": " . $zd_d4cfb_1402 . $zd_a78c2_3->CRLF . '<br />'; } return false; } return true; } public function SendAndMail($zd_5d2cb_225) { $zd_a78c2_3->error = null; if(!$zd_a78c2_3->connected()) { $zd_a78c2_3->error = array( "error" => "Called SendAndMail() without being connected"); return false; } fputs($zd_a78c2_3->smtp_conn,"SAML FROM:" . $zd_5d2cb_225 . $zd_a78c2_3->CRLF); $zd_d4cfb_1402 = $zd_a78c2_3->get_lines(); $zd_abfe6_1404 = substr($zd_d4cfb_1402,0,3); if($zd_a78c2_3->do_debug >= 2) { echo "SMTP -> FROM SERVER:" . $zd_d4cfb_1402 . $zd_a78c2_3->CRLF . '<br />'; } if($zd_abfe6_1404 != 250) { $zd_a78c2_3->error = array("error" => "SAML not accepted from server", "smtp_code" => $zd_abfe6_1404, "smtp_msg" => substr($zd_d4cfb_1402,4)); if($zd_a78c2_3->do_debug >= 1) { echo "SMTP -> ERROR: " . $zd_a78c2_3->error["error"] . ": " . $zd_d4cfb_1402 . $zd_a78c2_3->CRLF . '<br />'; } return false; } return true; } public function Turn() { $zd_a78c2_3->error = array("error" => "This method, TURN, of the SMTP ". "is not implemented"); if($zd_a78c2_3->do_debug >= 1) { echo "SMTP -> NOTICE: " . $zd_a78c2_3->error["error"] . $zd_a78c2_3->CRLF . '<br />'; } return false; } public function getError() { return $zd_a78c2_3->error; } private function get_lines() { $zd_6dc4b_1726 = ""; while(!feof($zd_a78c2_3->smtp_conn)) { $zd_36713_743 = @fgets($zd_a78c2_3->smtp_conn,515); if($zd_a78c2_3->do_debug >= 4) { echo "SMTP -> get_lines(): \$zd_6dc4b_1726 was \"$zd_6dc4b_1726\"" . $zd_a78c2_3->CRLF . '<br />'; echo "SMTP -> get_lines(): \$zd_36713_743 is \"$zd_36713_743\"" . $zd_a78c2_3->CRLF . '<br />'; } $zd_6dc4b_1726 .= $zd_36713_743; if($zd_a78c2_3->do_debug >= 4) { echo "SMTP -> get_lines(): \$zd_6dc4b_1726 is \"$zd_6dc4b_1726\"" . $zd_a78c2_3->CRLF . '<br />'; } if(substr($zd_36713_743,3,1) == " ") { break; } } return $zd_6dc4b_1726; } } function xn_send_mail($smtp, $username, $email, $subject, $message, $charset = 'UTF-8') { // hook xn_send_mail_start.php // hook xn_send_mail_data.php $zd_67860_0 = new PHPMailer(); $zd_67860_0->IsSMTP(); $zd_67860_0->IsHTML(TRUE); $zd_67860_0->SMTPDebug = 0; $zd_67860_0->SMTPAuth = TRUE; $zd_67860_0->Host = $smtp['host']; $zd_67860_0->Port = $smtp['port']; $zd_67860_0->Username = $smtp['user']; $zd_67860_0->Password = $smtp['pass']; $zd_67860_0->Timeout = 5; $zd_67860_0->CharSet = $charset; $zd_67860_0->Encoding = 'base64'; $zd_67860_0->SetFrom($smtp['email'], $username); $zd_67860_0->AddReplyTo($smtp['email'], $email); $zd_67860_0->Subject = $subject; $zd_67860_0->AltBody = $message; $message = str_replace("\\",'',$message); $zd_67860_0->MsgHTML($message); $zd_67860_0->AddAddress($email, $username); if(!$zd_67860_0->Send()) { return xn_error(-1, $zd_67860_0->ErrorInfo); } else { return TRUE; } // hook xn_send_mail_end.php } ?>
